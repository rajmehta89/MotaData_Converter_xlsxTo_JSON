Section #,Recommendation #,Profile,Title,Assessment Status,Description,Rationale Statement,Impact Statement,Remediation Procedure,Audit Procedure,Rule Check in,Rule configuration,conditions,result.pattern,occurence,operator,Additional Information,Rule Severity,CIS Controls,BLANK,BLANK,BLANK,CIS Safeguards 1 (v8),CIS Safeguards 2 (v8),CIS Safeguards 3 (v8),v8 IG1,v8 IG2,v8 IG3,CIS Safeguards 1 (v7),CIS Safeguards 2 (v7),CIS Safeguards 3 (v7),v7 IG1,v7 IG2,v7 IG3,References,Default Value
1,BLANK,BLANK,Management Plane,BLANK,Services, settings and data streams related to setting up and examining the static configuration of the firewall, and the authentication and authorization of firewall administrators. Examples of management plane services include: administrative device access (telnet, ssh, http, and https), SNMP, and security protocols like RADIUS and TACACS+.,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK
1.1,BLANK,BLANK,Local Authentication, Authorization and Accounting (AAA) Rules,BLANK,Rules in the Local authentication, authorization and accounting (AAA) configuration class enforce device access control, provide a mechanism for tracking configuration changes, and enforcing security policy.,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK
1.1,1.1.1,Level 1,Enable 'aaa new-model',Automated,This command enables the AAA access control system.,Authentication, authorization and accounting (AAA) services provide an authoritative source for managing and monitoring access for devices. Centralizing control improves consistency of access control, the services that may be accessed once authenticated and accountability by tracking services accessed. Additionally, centralizing access control simplifies and reduces administrative costs of account provisioning and de-provisioning, especially when managing a large number of devices.,Implementing Cisco AAA is significantly disruptive as former access methods are immediately disabled. Therefore, before implementing Cisco AAA, the organization should carefully review and plan their authentication criteria (logins & passwords, challenges & responses, and token technologies), authorization methods, and accounting requirements.,Globally enable authentication, authorization and accounting (AAA) using the new-model command.
```
hostname(config)#aaa new-model
```,Perform the following to determine if AAA services are enabled:
```
 hostname#show running-config | inc aaa new-model
```
If the result includes a "no", the feature is not enabled.,config file,basic,not contain,no aaa new-model,any,none,BLANK,Critical,TITLE:Centralize Account Management CONTROL:v8 5.6 DESCRIPTION:Centralize account management through a directory or identity service.,TITLE:Configure Centralized Point of Authentication CONTROL:v7 16.2 DESCRIPTION:Configure access for all accounts through as few centralized points of authentication as possible, including network, security, and cloud systems.,BLANK,BLANK,5.6,BLANK,BLANK,BLANK,X,X,16.2,BLANK,BLANK,BLANK,X,X,http://www.cisco.com/en/US/docs/ios-xml/ios/security/a1/sec-cr-a2.html#GUID-E05C2E00-C01E-4053-9D12-EC37C7E8EEC5,AAA is not enabled.
1.1,1.1.2,Level 1,Enable 'aaa authentication login',Automated,Sets authentication, authorization and accounting (AAA) authentication at login.,Using AAA authentication for interactive management access to the device provides consistent, centralized control of your network. The default under AAA (local or network) is to require users to log in using a valid user name and password. This rule applies for both local and network AAA. Fallback mode should also be enabled to allow emergency access to the router or switch in the event that the AAA server was unreachable, by utilizing the LOCAL keyword after the AAA server-tag.,Implementing Cisco AAA is significantly disruptive as former access methods are immediately disabled. Therefore, before implementing Cisco AAA, the organization should carefully review and plan their authentication methods such as logins and passwords, challenges and responses, and which token technologies will be used.,Configure AAA authentication method(s) for login authentication.
```
hostname(config)#aaa authentication login {default | aaa_list_name} [passwd-expiry]
[method1] [method2]

```,Perform the following to determine if AAA authentication for login is enabled:
```
hostname#show running-config | incl aaa authentication login
```
If a result does not return, the feature is not enabled.,config file,basic,contain,aaa authentication login
,any,none,Only “the default method list is automatically applied to all interfaces except those that have a named method list explicitly defined. A defined method list overrides the default method list.” (1),Critical,TITLE:Centralize Account Management CONTROL:v8 5.6 DESCRIPTION:Centralize account management through a directory or identity service.,TITLE:Configure Centralized Point of Authentication CONTROL:v7 16.2 DESCRIPTION:Configure access for all accounts through as few centralized points of authentication as possible, including network, security, and cloud systems.,BLANK,BLANK,5.6,BLANK,BLANK,BLANK,X,X,16.2,BLANK,BLANK,BLANK,X,X,http://www.cisco.com/en/US/docs/ios-xml/ios/security/a1/sec-cr-a1.html#GUID-3DB1CC8A-4A98-400B-A906-C42F265C7EA2,AAA authentication at login is disabled.
1.1,1.1.3,Level 1,Enable 'aaa authentication enable default',Automated,Authenticates users who access privileged EXEC mode when they use the enable command.,Using AAA authentication for interactive management access to the device provides consistent, centralized control of your network. The default under AAA (local or network) is to require users to log in using a valid user name and password. This rule applies for both local and network AAA.,Enabling Cisco AAA 'authentication enable' mode is significantly disruptive as former access methods are immediately disabled. Therefore, before enabling 'aaa authentication enable default' mode, the organization should plan and implement authentication logins and passwords, challenges and responses, and token technologies.,Configure AAA authentication method(s) for enable authentication.
```
hostname(config)#aaa authentication enable default {method1} enable 
```,Perform the following to determine if AAA authentication enable mode is enabled:
```
hostname#show running-config | incl aaa authentication enable
```
If a result does not return, the feature is not enabled,config file,basic,contain,aaa authentication enable
,any,none,BLANK,Critical,TITLE:Centralize Account Management CONTROL:v8 5.6 DESCRIPTION:Centralize account management through a directory or identity service.,TITLE:Configure Centralized Point of Authentication CONTROL:v7 16.2 DESCRIPTION:Configure access for all accounts through as few centralized points of authentication as possible, including network, security, and cloud systems.,BLANK,BLANK,5.6,BLANK,BLANK,BLANK,X,X,16.2,BLANK,BLANK,BLANK,X,X,http://www.cisco.com/en/US/docs/ios-xml/ios/security/a1/sec-cr-a1.html#GUID-4171D649-2973-4707-95F3-9D96971893D0,By default, fallback to the local database is disabled.
1.1,1.1.4,Level 1,Set 'login authentication for 'line vty',Automated,Authenticates users who access the router or switch remotely through the VTY port.,Using AAA authentication for interactive management access to the device provides consistent, centralized control of your network. The default under AAA (local or network) is to require users to log in using a valid user name and password. This rule applies for both local and network AAA.,Enabling Cisco AAA 'login authentication for line VTY' is significantly disruptive as former access methods are immediately disabled. Therefore, before enabling Cisco AAA 'login authentication for line VTY', the organization should plan and implement authentication logins and passwords, challenges and responses, and token technologies.,Configure management lines to require login using the default or a named AAA authentication list. This configuration must be set individually for all line types.
```
hostname(config)#line vty {line-number} [<em>ending-line-number]
hostname(config-line)#login authentication {default | aaa_list_name}
```,Perform the following to determine if AAA authentication for line login is enabled:

If the command does not return a result for each management access method, the feature is not enabled
```
hostname#show running-config | sec line | incl login authentication
```,config file,advance,BLANK,BLANK,BLANK,BLANK,BLANK,Critical,TITLE:Centralize Account Management CONTROL:v8 5.6 DESCRIPTION:Centralize account management through a directory or identity service.,TITLE:Configure Centralized Point of Authentication CONTROL:v7 16.2 DESCRIPTION:Configure access for all accounts through as few centralized points of authentication as possible, including network, security, and cloud systems.,BLANK,BLANK,5.6,BLANK,BLANK,BLANK,X,X,16.2,BLANK,BLANK,BLANK,X,X,http://www.cisco.com/en/US/docs/ios-xml/ios/security/d1/sec-cr-k1.html#GUID-297BDF33-4841-441C-83F3-4DA51C3C7284,Login authentication is not enabled.

Uses the default set with aaa authentication login.
1.1,1.1.5,Level 1,Set 'login authentication for 'ip http',Automated,If account management functions are not automatically enforced, an attacker could gain privileged access to a vital element of the network security architecture,Using AAA authentication for interactive management access to the device provides consistent, centralized control of your network. The default under AAA (local or network) is to require users to log in using a valid user name and password. This rule applies for both local and network AAA.,Enabling Cisco AAA 'line login' is significantly disruptive as former access methods are immediately disabled. Therefore, before enabling Cisco AAA 'line login', the organization should plan and implement authentication logins and passwords, challenges and responses, and token technologies.,Configure management lines to require login using the default or a named AAA authentication list. This configuration must be set individually for all line types.
```
hostname#(config)ip http secure-server
hostname#(config)ip http authentication {default | _aaa\_list\_name_}
```,Perform the following to determine if AAA authentication for line login is enabled:

If the command does not return a result for each management access method, the feature is not enabled
```
hostname#show running-config | inc ip http authentication
```,config file,basic,contain,\s*ip\s+http\s+authentication(\s+\S+)?,any,none,BLANK,Critical,TITLE:Centralize Account Management CONTROL:v8 5.6 DESCRIPTION:Centralize account management through a directory or identity service.,TITLE:Configure Centralized Point of Authentication CONTROL:v7 16.2 DESCRIPTION:Configure access for all accounts through as few centralized points of authentication as possible, including network, security, and cloud systems.,BLANK,BLANK,5.6,BLANK,BLANK,BLANK,X,X,16.2,BLANK,BLANK,BLANK,X,X,http://www.cisco.com/en/US/docs/ios-xml/ios/security/d1/sec-cr-k1.html#GUID-297BDF33-4841-441C-83F3-4DA51C3C7284,Login authentication is not enabled.

Uses the default set with aaa authentication login.
1.1,1.1.6,Level 2,Set 'aaa accounting' to log all privileged use commands using 'commands 15',Automated,Runs accounting for all commands at the specified privilege level.,Authentication, authorization and accounting (AAA) systems provide an authoritative source for managing and monitoring access for devices. Centralizing control improves consistency of access control, the services that may be accessed once authenticated and accountability by tracking services accessed. Additionally, centralizing access control simplifies and reduces administrative costs of account provisioning and de-provisioning, especially when managing a large number of devices. AAA Accounting provides a management and audit trail for user and administrative sessions through TACACS+.,Enabling 'aaa accounting' for privileged commands records and sends activity to the accounting servers and enables organizations to monitor and analyze privileged activity.,Configure AAA accounting for commands.
```
hostname(config)#aaa accounting commands 15 {default | list-name | guarantee-first}
{start-stop | stop-only | none} {radius | group group-name}
```,Perform the following to determine if aaa accounting for commands is required:

Verify a command string result returns
```
hostname#show running-config | incl aaa accounting commands
```,config file,basic,contain,aaa accounting commands \d+,any,none,Valid privilege level entries are integers from 0 through 15.,High,TITLE:Collect Audit Logs CONTROL:v8 8.2 DESCRIPTION:Collect audit logs. Ensure that logging, per the enterprise’s audit log management process, has been enabled across enterprise assets.,TITLE:Enable Detailed Logging CONTROL:v7 6.3 DESCRIPTION:Enable system logging to include detailed information such as an event source, date, user, timestamp, source addresses, destination addresses, and other useful elements.,BLANK,BLANK,8.2,BLANK,BLANK,X,X,X,6.3,BLANK,BLANK,BLANK,X,X,BLANK,AAA accounting is disabled.
1.1,1.1.7,Level 2,Set 'aaa accounting connection',Automated,Provides information about all outbound connections made from the network access server.,Authentication, authorization and accounting (AAA) systems provide an authoritative source for managing and monitoring access for devices. Centralizing control improves consistency of access control, the services that may be accessed once authenticated and accountability by tracking services accessed. Additionally, centralizing access control simplifies and reduces administrative costs of account provisioning and de-provisioning, especially when managing a large number of devices. AAA Accounting provides a management and audit trail for user and administrative sessions through RADIUS and TACACS+.,Implementing aaa accounting connection creates accounting records about connections from the network access server. Organizations should regular monitor these connection records for exceptions, remediate issues, and report findings regularly.,Configure AAA accounting for connections.
```
hostname(config)#aaa accounting connection {default | list-name | guarantee-first} 
{start-stop | stop-only | none} {radius | group group-name}
```,Perform the following to determine if aaa accounting for connection is required:

Verify a command string result returns
```
hostname#show running-config | incl aaa accounting connection
```,config file,basic,contain,aaa accounting connection,any,none,BLANK,High,TITLE:Centralize Account Management CONTROL:v8 5.6 DESCRIPTION:Centralize account management through a directory or identity service.,TITLE:Configure Centralized Point of Authentication CONTROL:v7 16.2 DESCRIPTION:Configure access for all accounts through as few centralized points of authentication as possible, including network, security, and cloud systems.,BLANK,BLANK,5.6,BLANK,BLANK,BLANK,X,X,16.2,BLANK,BLANK,BLANK,X,X,http://www.cisco.com/en/US/docs/ios-xml/ios/security/a1/sec-cr-a1.html#GUID-0520BCEF-89FB-4505-A5DF-D7F1389F1BBA,AAA accounting is not enabled.
1.1,1.1.8,Level 2,Set 'aaa accounting exec',Automated,Runs accounting for the EXEC shell session.,Authentication, authorization and accounting (AAA) systems provide an authoritative source for managing and monitoring access for devices. Centralizing control improves consistency of access control, the services that may be accessed once authenticated and accountability by tracking services accessed. Additionally, centralizing access control simplifies and reduces administrative costs of account provisioning and de-provisioning, especially when managing a large number of devices. AAA Accounting provides a management and audit trail for user and administrative sessions through RADIUS and TACACS+.,Enabling aaa accounting exec creates accounting records for the EXEC terminal sessions on the network access server. These records include start and stop times, usernames, and date information. Organizations should regularly monitor these records for exceptions, remediate issues, and report findings.,Configure AAA accounting for EXEC shell session.
```
hostname(config)#aaa accounting exec {default | list-name | guarantee-first} 
{start-stop | stop-only | none} {radius | group group-name}
```,Perform the following to determine if aaa accounting for EXEC shell session is required:

Verify a command string result returns
```
hostname#show running-config | incl aaa accounting exec
```,config file,basic,contain,aaa accounting exec,any,none,BLANK,High,TITLE:Collect Audit Logs CONTROL:v8 8.2 DESCRIPTION:Collect audit logs. Ensure that logging, per the enterprise’s audit log management process, has been enabled across enterprise assets.,TITLE:Enable Detailed Logging CONTROL:v7 6.3 DESCRIPTION:Enable system logging to include detailed information such as an event source, date, user, timestamp, source addresses, destination addresses, and other useful elements.,BLANK,BLANK,8.2,BLANK,BLANK,X,X,X,6.3,BLANK,BLANK,BLANK,X,X,http://www.cisco.com/en/US/docs/ios-xml/ios/security/a1/sec-cr-a1.html#GUID-0520BCEF-89FB-4505-A5DF-D7F1389F1BBA,AAA accounting is not enabled.
1.1,1.1.9,Level 2,Set 'aaa accounting network',Automated,Runs accounting for all network-related service requests.,Authentication, authorization and accounting (AAA) systems provide an authoritative source for managing and monitoring access for devices. Centralizing control improves consistency of access control, the services that may be accessed once authenticated and accountability by tracking services accessed. Additionally, centralizing access control simplifies and reduces administrative costs of account provisioning and de-provisioning, especially when managing a large number of devices. AAA Accounting provides a management and audit trail for user and administrative sessions through RADIUS and TACACS+.,Implementing aaa accounting network creates accounting records for a method list including ARA, PPP, SLIP, and NCPs sessions. Organizations should regular monitor these records for exceptions, remediate issues, and report findings.,Configure AAA accounting for connections.
```
hostname(config)#aaa accounting network {default | list-name | guarantee-first} 
{start-stop | stop-only | none} {radius | group group-name}
```,Perform the following to determine if aaa accounting for connection is required:

Verify a command string result returns
```
hostname#show running-config | incl aaa accounting network
```,config file,basic,contain,aaa accounting network,any,none,BLANK,High,TITLE:Collect Audit Logs CONTROL:v8 8.2 DESCRIPTION:Collect audit logs. Ensure that logging, per the enterprise’s audit log management process, has been enabled across enterprise assets.,TITLE:Enable Detailed Logging CONTROL:v7 6.3 DESCRIPTION:Enable system logging to include detailed information such as an event source, date, user, timestamp, source addresses, destination addresses, and other useful elements.,BLANK,BLANK,8.2,BLANK,BLANK,X,X,X,6.3,BLANK,BLANK,BLANK,X,X,http://www.cisco.com/en/US/docs/ios-xml/ios/security/a1/sec-cr-a1.html#GUID-0520BCEF-89FB-4505-A5DF-D7F1389F1BBA,AAA accounting is not enabled.
1.1,1.1.10,Level 2,Set 'aaa accounting system',Automated,Performs accounting for all system-level events not associated with users, such as reloads.,Authentication, authorization and accounting (AAA) systems provide an authoritative source for managing and monitoring access for devices. Centralizing control improves consistency of access control, the services that may be accessed once authenticated and accountability by tracking services accessed. Additionally, centralizing access control simplifies and reduces administrative costs of account provisioning and de-provisioning, especially when managing a large number of devices. AAA Accounting provides a management and audit trail for user and administrative sessions through RADIUS and TACACS+.,Enabling aaa accounting system creates accounting records for all system-level events. Organizations should regular monitor these records for exceptions, remediate issues, and report findings regularly.,Configure AAA accounting system.
```
hostname(config)#aaa accounting system {default | list-name | guarantee-first} 
{start-stop | stop-only | none} {radius | group group-name}
```,Perform the following to determine if aaa accounting system is required:

Verify a command string result returns
```
hostname#show running-config | incl aaa accounting system
```,config file,basic,contain,aaa accounting system,any,none,When system accounting is used and the accounting server is unreachable at system startup time, the system will not be accessible for approximately two minutes.,High,TITLE:Collect Audit Logs CONTROL:v8 8.2 DESCRIPTION:Collect audit logs. Ensure that logging, per the enterprise’s audit log management process, has been enabled across enterprise assets.,TITLE:Enable Detailed Logging CONTROL:v7 6.3 DESCRIPTION:Enable system logging to include detailed information such as an event source, date, user, timestamp, source addresses, destination addresses, and other useful elements.,BLANK,BLANK,8.2,BLANK,BLANK,X,X,X,6.3,BLANK,BLANK,BLANK,X,X,http://www.cisco.com/en/US/docs/ios-xml/ios/security/a1/sec-cr-a1.html#GUID-0520BCEF-89FB-4505-A5DF-D7F1389F1BBA,AAA accounting is not enabled.
1.2,BLANK,BLANK,Access Rules,BLANK,Rules in the access class enforce controls for device administrative connections.,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK
1.2,1.2.1,Level 1,Set 'privilege 1' for local users,Automated,Sets the privilege level for the user.,Default device configuration does not require strong user authentication potentially enabling unfettered access to an attacker that is able to reach the device. Creating a local account with privilege level 1 permissions only allows the local user to access the device with EXEC-level permissions and will be unable to modify the device without using the enable password. In addition, require the use of an encrypted password as well (see Section 1.1.4.4 - Require Encrypted User Passwords).,Organizations should create policies requiring all local accounts with 'privilege level 1' with encrypted passwords to reduce the risk of unauthorized access. Default configuration settings do not provide strong user authentication to the device.,Set the local user to privilege level 1.
```
hostname(config)#username <LOCAL_USERNAME> privilege 1 
```,Perform the following to determine if a user with an encrypted password is enabled:

Verify all username results return "privilege 1"
```
hostname#show running-config | incl privilege
```,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,Critical,TITLE:Explicitly Not Mapped CONTROL:v8 0.0 DESCRIPTION:Explicitly Not Mapped,TITLE:Explicitly Not Mapped CONTROL:v7 0.0 DESCRIPTION:Explicitly Not Mapped,BLANK,BLANK,0.0,BLANK,BLANK,BLANK,BLANK,BLANK,0.0,BLANK,BLANK,BLANK,BLANK,BLANK,http://www.cisco.com/en/US/docs/ios-xml/ios/security/s1/sec-cr-t2-z.html#GUID-34B3E43E-0F79-40E8-82B6-A4B5F1AFF1AD,BLANK
1.2,1.2.2,Level 1,Set 'transport input ssh' for 'line vty' connections,Automated,Selects the Secure Shell (SSH) protocol.,Configuring VTY access control restricts remote access to only those authorized to manage the device and prevents unauthorized users from accessing the system.,To reduce risk of unauthorized access, organizations should require all VTY management line protocols to be limited to ssh.,Apply SSH to transport input on all VTY management lines
```
hostname(config)#line vty <line-number> <ending-line-number>
hostname(config-line)#transport input ssh 
```,Perform the following to determine if SSH is the only transport method for incoming VTY logins:

The result should show only "ssh" for "transport input"
```
hostname#show running-config | sec vty 
```,config file,advance,BLANK,BLANK,BLANK,BLANK,BLANK,Critical,TITLE:Require MFA for Administrative Access CONTROL:v8 6.5 DESCRIPTION:Require MFA for all administrative access accounts, where supported, on all enterprise assets, whether managed on-site or through a third-party provider.,TITLE:Use Multifactor Authentication For All Administrative Access CONTROL:v7 4.5 DESCRIPTION:Use multi-factor authentication and encrypted channels for all administrative account access.,BLANK,BLANK,6.5,BLANK,BLANK,X,X,X,4.5,BLANK,BLANK,BLANK,X,X,http://www.cisco.com/en/US/docs/ios/termserv/command/reference/tsv_s1.html#wp1069219,BLANK
1.2,1.2.3,Level 1,Set 'no exec' for 'line aux 0',Automated,The 'no exec' command restricts a line to outgoing connections only.,Unused ports should be disabled, if not required, since they provide a potential access path for attackers. Some devices include both an auxiliary and console port that can be used to locally connect to and configure the device. The console port is normally the primary port used to configure the device; even when remote, backup administration is required via console server or Keyboard, Video, Mouse (KVM) hardware. The auxiliary port is primarily used for dial-up administration via an external modem; instead, use other available methods.,Organizations can reduce the risk of unauthorized access by disabling the 'aux' port with the 'no exec' command. Conversely, not restricting access through the 'aux' port increases the risk of remote unauthorized access.,Disable the EXEC process on the auxiliary port.
```
hostname(config)#line aux 0
hostname(config-line)#no exec
```,Perform the following to determine if the EXEC process for the aux port is disabled:

Verify no exec
```
hostname#show running-config | sec aux
```
Verify you see the following "no exec"
```
hostname#show line aux 0 | incl exec
```,config file,advance,BLANK,BLANK,BLANK,BLANK,BLANK,Critical,TITLE:Explicitly Not Mapped CONTROL:v8 0.0 DESCRIPTION:Explicitly Not Mapped,TITLE:Ensure Only Approved Ports, Protocols and Services Are Running CONTROL:v7 9.2 DESCRIPTION:Ensure that only network ports, protocols, and services listening on a system with validated business needs, are running on each system.,BLANK,BLANK,0.0,BLANK,BLANK,BLANK,BLANK,BLANK,9.2,BLANK,BLANK,BLANK,X,X,http://www.cisco.com/en/US/docs/ios-xml/ios/fundamentals/command/D_through_E.html#GUID-429A2B8C-FC26-49C4-94C4-0FD99C32EC34,BLANK
1.2,1.2.4,Level 1,Create 'access-list' for use with 'line vty',Automated,Access lists control the transmission of packets on an interface, control Virtual Terminal Line (VTY) access, and restrict the contents of routing updates. The Cisco IOS software stops checking the extended access list after a match occurs.,VTY ACLs control what addresses may attempt to log in to the router. Configuring VTY lines to use an ACL, restricts the sources where a user can manage the device. You should limit the specific host(s) and or network(s) authorized to connect to and configure the device, via an approved protocol, to those individuals or systems authorized to administer the device. For example, you could limit access to specific hosts, so that only network managers can configure the devices only by using specific network management workstations. Make sure you configure all VTY lines to use the same ACL.,Organizations can reduce the risk of unauthorized access by implementing access-lists for all VTY lines. Conversely, using VTY lines without access-lists increases the risk of unauthorized access.,Configure the VTY ACL that will be used to restrict management access to the device.
```
hostname(config)#access-list <vty_acl_number> permit tcp <vty_acl_block_with_mask> any
hostname(config)#access-list <vty_acl_number> permit tcp host <vty_acl_host> any
hostname(config)#deny ip any any log
```,Perform the following to determine if the ACL is created:

Verify the appropriate access-list definitions
```
hostname#sh ip access-list <vty_acl_number>
```,cli,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,Critical,TITLE:Establish and Maintain Dedicated Computing Resources for All Administrative Work CONTROL:v8 12.8 DESCRIPTION:Establish and maintain dedicated computing resources, either physically or logically separated, for all administrative tasks or tasks requiring administrative access. The computing resources should be segmented from the enterprise's primary network and not be allowed internet access.,TITLE:Manage Network Infrastructure Through a Dedicated Network CONTROL:v7 11.7 DESCRIPTION:Manage the network infrastructure across network connections that are separated from the business use of that network, relying on separate VLANs or, preferably, on entirely different physical connectivity for management sessions for network devices.,BLANK,BLANK,12.8,BLANK,BLANK,BLANK,BLANK,X,11.7,BLANK,BLANK,BLANK,X,X,http://www.cisco.com/en/US/docs/ios-xml/ios/security/a1/sec-cr-a2.html#GUID-9EA733A3-1788-4882-B8C3-AB0A2949120C,BLANK
1.2,1.2.5,Level 1,Set 'access-class' for 'line vty',Automated,The 'access-class' setting restricts incoming and outgoing connections between a particular vty (into a Cisco device) and the networking devices associated with addresses in an access list.,Restricting the type of network devices, associated with the addresses on the access-list, further restricts remote access to those devices authorized to manage the device and reduces the risk of unauthorized access.,Applying 'access'class' to line VTY further restricts remote access to only those devices authorized to manage the device and reduces the risk of unauthorized access. Conversely, using VTY lines with 'access class' restrictions increases the risks of unauthorized access.,Configure remote management access control restrictions for all VTY lines.
```
hostname(config)#line vty <line-number> <ending-line-number>
hostname(config-line)# access-class <vty_acl_number> in
```,Perform the following to determine if the ACL is set:

Verify you see the access-class defined
```
hostname#sh run | sec vty <line-number> <ending-line-number>
```,config file,advance,BLANK,BLANK,BLANK,BLANK,BLANK,Critical,TITLE:Establish and Maintain Dedicated Computing Resources for All Administrative Work CONTROL:v8 12.8 DESCRIPTION:Establish and maintain dedicated computing resources, either physically or logically separated, for all administrative tasks or tasks requiring administrative access. The computing resources should be segmented from the enterprise's primary network and not be allowed internet access.,TITLE:Manage Network Infrastructure Through a Dedicated Network CONTROL:v7 11.7 DESCRIPTION:Manage the network infrastructure across network connections that are separated from the business use of that network, relying on separate VLANs or, preferably, on entirely different physical connectivity for management sessions for network devices.,BLANK,BLANK,12.8,BLANK,BLANK,BLANK,BLANK,X,11.7,BLANK,BLANK,BLANK,X,X,http://www.cisco.com/en/US/docs/ios-xml/ios/security/a1/sec-cr-a2.html#GUID-FB9BC58A-F00A-442A-8028-1E9E260E54D3,BLANK
1.2,1.2.6,Level 1,Set 'exec-timeout' to less than or equal to 10 minutes for 'line aux 0',Automated,If no input is detected during the interval, the EXEC facility resumes the current connection. If no connections exist, the EXEC facility returns the terminal to the idle state and disconnects the incoming session.,This prevents unauthorized users from misusing abandoned sessions. For example, if the network administrator leaves for the day and leaves a computer open with an enabled login session accessible. There is a trade-off here between security (shorter timeouts) and usability (longer timeouts). Review your local policies and operational needs to determine the best timeout value. In most cases, this should be no more than 10 minutes.,Organizations should prevent unauthorized use of unattended or abandoned sessions by an automated control. Enabling 'exec-timeout' with an appropriate length of minutes or seconds prevents unauthorized access of abandoned sessions.,Configure device timeout (10 minutes or less) to disconnect sessions after a fixed idle time.
```
hostname(config)#line aux 0
hostname(config-line)#exec-timeout <timeout_in_minutes> <timeout_in_seconds>
```,Perform the following to determine if the timeout is configured:

Verify you return a result NOTE: If you set an exec-timeout of 10 minutes, this will not show up in the configuration
```
hostname#sh run | sec line aux 0
```,config file,advance,BLANK,BLANK,BLANK,BLANK,BLANK,Critical,TITLE:Configure Automatic Session Locking on Enterprise Assets CONTROL:v8 4.3 DESCRIPTION:Configure automatic session locking on enterprise assets after a defined period of inactivity. For general purpose operating systems, the period must not exceed 15 minutes. For mobile end-user devices, the period must not exceed 2 minutes.,TITLE:Lock Workstation Sessions After Inactivity CONTROL:v7 16.11 DESCRIPTION:Automatically lock workstation sessions after a standard period of inactivity.,BLANK,BLANK,4.3,BLANK,BLANK,X,X,X,16.11,BLANK,BLANK,X,X,X,http://www.cisco.com/en/US/docs/ios-xml/ios/fundamentals/command/D_through_E.html#GUID-76805E6F-9E89-4457-A9DC-5944C8FE5419,BLANK
1.2,1.2.7,Level 1,Set 'exec-timeout' to less than or equal to 10 minutes 'line console 0',Automated,If no input is detected during the interval, the EXEC facility resumes the current connection. If no connections exist, the EXEC facility returns the terminal to the idle state and disconnects the incoming session.,This prevents unauthorized users from misusing abandoned sessions. For example, if the network administrator leaves for the day and leaves a computer open with an enabled login session accessible. There is a trade-off here between security (shorter timeouts) and usability (longer timeouts). Review your local policies and operational needs to determine the best timeout value. In most cases, this should be no more than 10 minutes.,Organizations should prevent unauthorized use of unattended or abandoned sessions by an automated control. Enabling 'exec-timeout' with an appropriate length reduces the risk of unauthorized access of abandoned sessions.,Configure device timeout (10 minutes or less) to disconnect sessions after a fixed idle time.
```
hostname(config)#line con 0
hostname(config-line)#exec-timeout <timeout_in_minutes> <timeout_in_seconds>
```,Perform the following to determine if the timeout is configured:

Verify you return a result NOTE: If you set an exec-timeout of 10 minutes, this will not show up in the configuration
```
hostname#sh run | sec line con 0
```,config file,advance,BLANK,BLANK,BLANK,BLANK,BLANK,Critical,TITLE:Configure Automatic Session Locking on Enterprise Assets CONTROL:v8 4.3 DESCRIPTION:Configure automatic session locking on enterprise assets after a defined period of inactivity. For general purpose operating systems, the period must not exceed 15 minutes. For mobile end-user devices, the period must not exceed 2 minutes.,TITLE:Lock Workstation Sessions After Inactivity CONTROL:v7 16.11 DESCRIPTION:Automatically lock workstation sessions after a standard period of inactivity.,BLANK,BLANK,4.3,BLANK,BLANK,X,X,X,16.11,BLANK,BLANK,X,X,X,http://www.cisco.com/en/US/docs/ios-xml/ios/fundamentals/command/D_through_E.html#GUID-76805E6F-9E89-4457-A9DC-5944C8FE5419,BLANK
1.2,1.2.8,Level 1,Set 'exec-timeout' to less than or equal to 10 minutes 'line vty',Automated,If no input is detected during the interval, the EXEC facility resumes the current connection. If no connections exist, the EXEC facility returns the terminal to the idle state and disconnects the incoming session.,This prevents unauthorized users from misusing abandoned sessions. For example, if the network administrator leaves for the day and leaves a computer open with an enabled login session accessible. There is a trade-off here between security (shorter timeouts) and usability (longer timeouts). Review your local policies and operational needs to determine the best timeout value. In most cases, this should be no more than 10 minutes.,Organizations should prevent unauthorized use of unattended or abandoned sessions by an automated control. Enabling 'exec-timeout' with an appropriate length of minutes or seconds prevents unauthorized access of abandoned sessions.,Configure device timeout (10 minutes or less) to disconnect sessions after a fixed idle time.
```
hostname(config)#line vty {line_number} [ending_line_number]
hostname(config-line)#exec-timeout <<span>timeout_in_minutes> <timeout_in_seconds</span>>
```,Perform the following to determine if the timeout is configured:

Verify you return a result NOTE: If you set an exec-timeout of 10 minutes, this will not show up in the configuration
```
hostname#sh line vty <tty_line_number> | begin Timeout
```,cli,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,Critical,TITLE:Configure Automatic Session Locking on Enterprise Assets CONTROL:v8 4.3 DESCRIPTION:Configure automatic session locking on enterprise assets after a defined period of inactivity. For general purpose operating systems, the period must not exceed 15 minutes. For mobile end-user devices, the period must not exceed 2 minutes.,TITLE:Lock Workstation Sessions After Inactivity CONTROL:v7 16.11 DESCRIPTION:Automatically lock workstation sessions after a standard period of inactivity.,BLANK,BLANK,4.3,BLANK,BLANK,X,X,X,16.11,BLANK,BLANK,X,X,X,https://www.cisco.com/c/en/us/td/docs/switches/datacenter/mds9000/sw/command/b_cisco_mds_9000_cr_book/l_commands.html#wp3716128869,BLANK
1.2,1.2.9,Level 1,Set 'transport input none' for 'line aux 0',Automated,When you want to allow only an outgoing connection on a line, use the no exec command.,Unused ports should be disabled, if not required, since they provide a potential access path for attackers. Some devices include both an auxiliary and console port that can be used to locally connect to and configure the device. The console port is normally the primary port used to configure the device; even when remote, backup administration is required via console server or Keyboard, Video, Mouse (KVM) hardware. The auxiliary port is primarily used for dial-up administration via an external modem; instead, use other available methods.,Organizations should prevent all unauthorized access of auxiliary ports by disabling all protocols using the 'transport input none' command.,Disable the inbound connections on the auxiliary port.
```
hostname(config)#line aux 0
hostname(config-line)#transport input none 
```,Perform the following to determine if inbound connections for the aux port are disabled:

Verify you see the following "Allowed input transports are none
```
hostname#sh line aux 0 | incl input transports 
```,cli,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,Critical,TITLE:Configure Automatic Session Locking on Enterprise Assets CONTROL:v8 4.3 DESCRIPTION:Configure automatic session locking on enterprise assets after a defined period of inactivity. For general purpose operating systems, the period must not exceed 15 minutes. For mobile end-user devices, the period must not exceed 2 minutes.,TITLE:Lock Workstation Sessions After Inactivity CONTROL:v7 16.11 DESCRIPTION:Automatically lock workstation sessions after a standard period of inactivity.,BLANK,BLANK,4.3,BLANK,BLANK,X,X,X,16.11,BLANK,BLANK,X,X,X,http://www.cisco.com/en/US/docs/ios/termserv/command/reference/tsv_s1.html#wp1069219,BLANK
1.2,1.2.10,Level 1,Set 'http Secure-server' limit,Automated,Device management includes the ability to control the number of administrators and management sessions that manage a device. Limiting the number of allowed administrators and sessions per administrator based on account type, role, or access type is helpful in limiting risks related to denial-of-service (DoS) attacks.,This requirement addresses concurrent sessions for administrative accounts and does not address concurrent sessions by a single administrator via multiple administrative accounts. The maximum number of concurrent sessions should be defined based upon mission needs and the operational environment for each system. At a minimum, limits must be set for SSH, HTTPS, account of last resort, and root account sessions. Center for Internet Security recommends a limit of 2,BLANK,```
hostname(config)#ip http max-connections 2
```,The result should show ip http secure-server with max connections on following line
```
hostname#show run | inc ip http secure-server
```,config file,basic,contain,ip http secure-server,1.0,none,BLANK,Critical,TITLE:Explicitly Not Mapped CONTROL:v8 0.0 DESCRIPTION:Explicitly Not Mapped,TITLE:Explicitly Not Mapped CONTROL:v7 0.0 DESCRIPTION:Explicitly Not Mapped,BLANK,BLANK,0.0,BLANK,BLANK,BLANK,BLANK,BLANK,0.0,BLANK,BLANK,BLANK,BLANK,BLANK,NIST SP 800-53 :: AC-10:https://www.tenable.com/audits/items/DISA_STIG_Cisco_IOS_XE_Switch_NDM_v2r1.audit:392b7a414732407810fa9d87c5a0d581,BLANK
BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,contain,ip http max-connections \d+,1.0,and,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK
1.2,1.2.11,Level 1,Set 'exec-timeout' to less than or equal to 10 min on 'ip http',Automated,If no input is detected during the interval, the EXEC facility resumes the current connection. If no connections exist, the EXEC facility returns the terminal to the idle state and disconnects the incoming session.,This prevents unauthorized users from misusing abandoned sessions. For example, if the network administrator leaves for the day and leaves a computer open with an enabled login session accessible. There is a trade-off here between security (shorter timeouts) and usability (longer timeouts). Review your local policies and operational needs to determine the best timeout value. In most cases, this should be no more than 10 minutes.

This prevents unauthorized users from misusing abandoned sessions. For example, if the network administrator leaves for the day and leaves a computer open with an enabled login session accessible. There is a trade-off here between security (shorter timeouts) and usability (longer timeouts). Review your local policies and operational needs to determine the best timeout value. In most cases, this should be no more than 10 minutes.,BLANK,Configure device timeout (10 minutes or less) to disconnect sessions after a fixed idle time.
```
ip http timeout-policy idle 600 life {nnnn} requests {nn}
```,Perform the following to determine if the timeout is configured:
```
sh run | beg ip http timeout-policy
```,config file,basic,contain,ip http timeout-policy,any,none,BLANK,Critical,TITLE:Configure Automatic Session Locking on Enterprise Assets CONTROL:v8 4.3 DESCRIPTION:Configure automatic session locking on enterprise assets after a defined period of inactivity. For general purpose operating systems, the period must not exceed 15 minutes. For mobile end-user devices, the period must not exceed 2 minutes.,TITLE:Lock Workstation Sessions After Inactivity CONTROL:v7 16.11 DESCRIPTION:Automatically lock workstation sessions after a standard period of inactivity.,BLANK,BLANK,4.3,BLANK,BLANK,X,X,X,16.11,BLANK,BLANK,X,X,X,http://www.cisco.com/en/US/docs/ios-xml/ios/fundamentals/command/D_through_E.html#GUID-76805E6F-9E89-4457-A9DC-5944C8FE5419,disabled
1.3,BLANK,BLANK,Banner Rules,BLANK,Rules in the banner class communicate legal rights to users.,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK
1.3,1.3.1,Level 1,Set the 'banner-text' for 'banner exec',Automated,This command specifies a message to be displayed when an EXEC process is created (a line is activated, or an incoming connection is made to a vty). Follow this command with one or more blank spaces and a delimiting character of your choice. Then enter one or more lines of text, terminating the message with the second occurrence of the delimiting character.

When a user connects to a router, the message-of-the-day (MOTD) banner appears first, followed by the login banner and prompts. After the user logs in to the router, the EXEC banner or incoming banner will be displayed, depending on the type of connection. For a reverse Telnet login, the incoming banner will be displayed. For all other connections, the router will display the EXEC banner.,"Network banners are electronic messages that provide notice of legal rights to users of computer networks. From a legal standpoint, banners have four primary functions.

- First, banners may be used to generate consent to real-time monitoring under Title III.
- Second, banners may be used to generate consent to the retrieval of stored files and records pursuant to ECPA.
- Third, in the case of government networks, banners may eliminate any Fourth Amendment "reasonable expectation of privacy" that government employees or other users might otherwise retain in their use of the government's network under O'Connor v. Ortega, 480 U.S. 709 (1987).
- Fourth, in the case of a non-government network, banners may establish a system administrator's "common authority" to consent to a law enforcement search pursuant to United States v. Matlock, 415 U.S. 164 (1974)." (US Department of Justice APPENDIX A: Sample Network Banner Language),Organizations provide appropriate legal notice(s) and warning(s) to persons accessing their networks by using a 'banner-text' for the banner exec command.,Configure the EXEC banner presented to a user when accessing the devices enable prompt.
```

hostname(config)#banner exec c
Enter TEXT message. End with the character 'c'.
<banner-text>
c
```,Perform the following to determine if the exec banner is set:
```

hostname#sh running-config | beg banner exec
```
If the command does not return a result, the banner is not enabled,config file,basic,contain,banner exec,any,none,The default is no banner.,Medium,TITLE:Establish and Maintain a Security Awareness Program CONTROL:v8 14.1 DESCRIPTION:Establish and maintain a security awareness program. The purpose of a security awareness program is to educate the enterprise’s workforce on how to interact with enterprise assets and data in a secure manner. Conduct training at hire and, at a minimum, annually. Review and update content annually, or when significant enterprise changes occur that could impact this Safeguard.,TITLE:Implement a Security Awareness Program CONTROL:v7 17.3 DESCRIPTION:Create a security awareness program for all workforce members to complete on a regular basis to ensure they understand and exhibit the necessary behaviors and skills to help ensure the security of the organization. The organization's security awareness program should be communicated in a continuous and engaging manner.,BLANK,BLANK,14.1,BLANK,BLANK,X,X,X,17.3,BLANK,BLANK,X,X,X,http://www.cisco.com/en/US/docs/ios-xml/ios/fundamentals/command/A_through_B.html#GUID-0DEF5B57-A7D9-4912-861F-E837C82A3881,No banner is set by default
1.3,1.3.2,Level 1,Set the 'banner-text' for 'banner login',Automated,Follow the banner login command with one or more blank spaces and a delimiting character of your choice. Then enter one or more lines of text, terminating the message with the second occurrence of the delimiting character.

When a user connects to the router, the message-of-the-day (MOTD) banner (if configured) appears first, followed by the login banner and prompts. After the user successfully logs in to the router, the EXEC banner or incoming banner will be displayed, depending on the type of connection. For a reverse Telnet login, the incoming banner will be displayed. For all other connections, the router will display the EXEC banner.,"Network banners are electronic messages that provide notice of legal rights to users of computer networks. From a legal standpoint, banners have four primary functions.

- First, banners may be used to generate consent to real-time monitoring under Title III.
- Second, banners may be used to generate consent to the retrieval of stored files and records pursuant to ECPA.
- Third, in the case of government networks, banners may eliminate any Fourth Amendment "reasonable expectation of privacy" that government employees or other users might otherwise retain in their use of the government's network under O'Connor v. Ortega, 480 U.S. 709 (1987).
- Fourth, in the case of a non-government network, banners may establish a system administrator's "common authority" to consent to a law enforcement search pursuant to United States v. Matlock, 415 U.S. 164 (1974)." (US Department of Justice APPENDIX A: Sample Network Banner Language),Organizations provide appropriate legal notice(s) and warning(s) to persons accessing their networks by using a 'banner-text' for the banner login command.,Configure the device so a login banner presented to a user attempting to access the device.
```

hostname(config)#banner login c
Enter TEXT message. End with the character 'c'.
<banner-text>
c
```,Perform the following to determine if the login banner is set:
```

hostname#show running-config | beg banner login
```
If the command does not return a result, the banner is not enabled.,config file,basic,contain,banner login,any,none,BLANK,Medium,TITLE:Establish and Maintain a Security Awareness Program CONTROL:v8 14.1 DESCRIPTION:Establish and maintain a security awareness program. The purpose of a security awareness program is to educate the enterprise’s workforce on how to interact with enterprise assets and data in a secure manner. Conduct training at hire and, at a minimum, annually. Review and update content annually, or when significant enterprise changes occur that could impact this Safeguard.,TITLE:Implement a Security Awareness Program CONTROL:v7 17.3 DESCRIPTION:Create a security awareness program for all workforce members to complete on a regular basis to ensure they understand and exhibit the necessary behaviors and skills to help ensure the security of the organization. The organization's security awareness program should be communicated in a continuous and engaging manner.,BLANK,BLANK,14.1,BLANK,BLANK,X,X,X,17.3,BLANK,BLANK,X,X,X,http://www.cisco.com/en/US/docs/ios-xml/ios/fundamentals/command/A_through_B.html#GUID-FF0B6890-85B8-4B6A-90DD-1B7140C5D22F,No banner is set by default
1.3,1.3.3,Level 1,Set the 'banner-text' for 'banner motd',Automated,This MOTD banner is displayed to all terminals connected and is useful for sending messages that affect all users (such as impending system shutdowns). Use the no exec-banner or no motd-banner command to disable the MOTD banner on a line. The no exec-banner command also disables the EXEC banner on the line.

When a user connects to the router, the MOTD banner appears before the login prompt. After the user logs in to the router, the EXEC banner or incoming banner will be displayed, depending on the type of connection. For a reverse Telnet login, the incoming banner will be displayed. For all other connections, the router will display the EXEC banner.,"Network banners are electronic messages that provide notice of legal rights to users of computer networks. From a legal standpoint, banners have four primary functions.

- First, banners may be used to generate consent to real-time monitoring under Title III.
- Second, banners may be used to generate consent to the retrieval of stored files and records pursuant to ECPA.
- Third, in the case of government networks, banners may eliminate any Fourth Amendment "reasonable expectation of privacy" that government employees or other users might otherwise retain in their use of the government's network under O'Connor v. Ortega, 480 U.S. 709 (1987).
- Fourth, in the case of a non-government network, banners may establish a system administrator's "common authority" to consent to a law enforcement search pursuant to United States v. Matlock, 415 U.S. 164 (1974)." (US Department of Justice APPENDIX A: Sample Network Banner Language),Organizations provide appropriate legal notice(s) and warning(s) to persons accessing their networks by using a 'banner-text' for the banner motd command.,Configure the message of the day (MOTD) banner presented when a user first connects to the device.
```

hostname(config)#banner motd c
Enter TEXT message. End with the character 'c'.
<banner-text>
c
```,Perform the following to determine if the login banner is set:
```

hostname#sh running-config | beg banner motd
```
If the command does not return a result, the banner is not enabled.,config file,basic,contain,banner motd,any,none,BLANK,Medium,TITLE:Establish and Maintain a Security Awareness Program CONTROL:v8 14.1 DESCRIPTION:Establish and maintain a security awareness program. The purpose of a security awareness program is to educate the enterprise’s workforce on how to interact with enterprise assets and data in a secure manner. Conduct training at hire and, at a minimum, annually. Review and update content annually, or when significant enterprise changes occur that could impact this Safeguard.,TITLE:Implement a Security Awareness Program CONTROL:v7 17.3 DESCRIPTION:Create a security awareness program for all workforce members to complete on a regular basis to ensure they understand and exhibit the necessary behaviors and skills to help ensure the security of the organization. The organization's security awareness program should be communicated in a continuous and engaging manner.,BLANK,BLANK,14.1,BLANK,BLANK,X,X,X,17.3,BLANK,BLANK,X,X,X,http://www.cisco.com/en/US/docs/ios-xml/ios/fundamentals/command/A_through_B.html#GUID-7416C789-9561-44FC-BB2A-D8D8AFFB77DD,No banner is set by default
1.3,1.3.4,Level 1,Set the 'banner-text' for 'webauth banner',Automated,This banner is displayed to all terminals connected and is useful for sending messages that affect all users (such as impending system shutdowns). Use the no exec-banner or no motd-banner command to disable the banner on a line. The no exec-banner command also disables the EXEC banner on the line.

When a user connects to the router, the MOTD banner appears before the login prompt. After the user logs in to the router, the EXEC banner or incoming banner will be displayed, depending on the type of connection. For a reverse Telnet login, the incoming banner will be displayed. For all other connections, the router will display the EXEC banner.,"Network banners are electronic messages that provide notice of legal rights to users of computer networks. From a legal standpoint, banners have four primary functions.

- First, banners may be used to generate consent to real-time monitoring under Title III.
- Second, banners may be used to generate consent to the retrieval of stored files and records pursuant to ECPA.
- Third, in the case of government networks, banners may eliminate any Fourth Amendment "reasonable expectation of privacy" that government employees or other users might otherwise retain in their use of the government's network under O'Connor v. Ortega, 480 U.S. 709 (1987).
- Fourth, in the case of a non-government network, banners may establish a system administrator's "common authority" to consent to a law enforcement search pursuant to United States v. Matlock, 415 U.S. 164 (1974)." (US Department of Justice APPENDIX A: Sample Network Banner Language),Organizations provide appropriate legal notice(s) and warning(s) to persons accessing their networks by using a 'banner-text' for the banner motd command.,Configure the webauth banner presented when a user connects to the device.
```
hostname(config)#ip admission auth-proxy-banner http {banner-text | filepath}
```,Perform the following to determine if the login banner is set:
```

hostname#show ip admission auth-proxy-banner http
```
If the command does not return a result, the banner is not enabled.,cli,BLANK,BLANK,Medium,TITLE:Establish and Maintain a Security Awareness Program CONTROL:v8 14.1 DESCRIPTION:Establish and maintain a security awareness program. The purpose of a security awareness program is to educate the enterprise’s workforce on how to interact with enterprise assets and data in a secure manner. Conduct training at hire and, at a minimum, annually. Review and update content annually, or when significant enterprise changes occur that could impact this Safeguard.,TITLE:Implement a Security Awareness Program CONTROL:v7 17.3 DESCRIPTION:Create a security awareness program for all workforce members to complete on a regular basis to ensure they understand and exhibit the necessary behaviors and skills to help ensure the security of the organization. The organization's security awareness program should be communicated in a continuous and engaging manner.,BLANK,BLANK,14.1,BLANK,BLANK,X,X,X,17.3,BLANK,BLANK,X,X,X,https://www.cisco.com/c/en/us/td/docs/switches/lan/catalyst9500/software/release/16-9/configuration_guide/sec/b_169_sec_9500_cg/configuring_web_based_authentication.html,No banner is set by default
1.4,BLANK,BLANK,Password Rules,BLANK,Rules in the password class enforce secure, local device authentication credentials.,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK
1.4,1.4.1,Level 1,Set 'password' for 'enable secret',Automated,Enable secret password type 5 and enable secret password type 5 must be migrated to the stronger password type 8 or 9. IF a device is upgraded from IOS XE 16.9 or later the type 5 is auto converted to type 9.

Use the enable secret command to provide an additional layer of security over the enable password. The enable secret command provides better security by storing the enable secret password using a nonreversible cryptographic function. The added layer of security encryption provides is useful in environments where the password crosses the network or is stored on a TFTP server.,Requiring the enable secret setting protects privileged EXEC mode. By default, a strong password is not required, a user can just press the Enter key at the Password prompt to start privileged mode. The enable password command causes the device to enforce use of a password to access privileged mode. Enable secrets use a one-way cryptographic hash (MD5). This is preferred to Level 7 enable passwords that use a weak, well-known, and easily reversible encryption algorithm.,Default device configuration does not require strong user authentication potentially enabling unfettered access to an attacker that is able to reach the device. Creating a local account with an encrypted password enforces login authentication and provides a fallback authentication mechanism for configuration in a named method list in a situation where centralized authentication, authorization, and accounting services are unavailable. The following is the type of encryption the device will allow as of 15.3: Type 0 this mean the password will not be encrypted when router store it in Run/Start Files command: enable password cisco123

Type 4 this mean the password will be encrypted when router store it in Run/Start Files using SHA-256 which apps like Cain can crack but will take long time command : enable secret 4 Rv4kArhts7yA2xd8BD2YTVbts (notice above is not the password string it self but the hash of the password)

this type is deprecated starting from IOS 15.3(3)

**_Type 5_** this mean the password will be encrypted when router store it in Run/Start Files using MD5 which apps like Cain can crack but will take long time command: enable secret 5 00271A5307542A02D22842 (notice above is not the password string it self but the hash of the password) or enable secret cisco123 (notice above is the password string it self)

**_Type 7_** this mean the password will be encrypted when router store it in Run/Start Files using Vigenere cipher which any website with type7 reverser can crack it in less than one second command : ena password cisco123 service password-encryption

**_Type 8_**

this mean the password will be encrypted when router store it in Run/Start Files using PBKDF2-SHA-256

starting from IOS 15.3(3).

Password-Based Key Derivation Function 2 (PBKDF2) with Secure Hash Algorithm, 26-bits (SHA-256) as the hashing algorithm

Example :
R1(config)#enable algorithm-type sha256 secret cisco

R1(config)#do sh run | i enable

enable secret 8 $8$mTj4RZG8N9ZDOk$elY/asfm8kD3iDmkBe3hD2r4xcA/0oWS5V3os.O91u.

Example :
R1(config)# username yasser algorithm-type sha256 secret cisco

R1# show running-config | inc username

username yasser secret 8 $8$dsYGNam3K1SIJO$7nv/35M/qr6t.dVc7UY9zrJDWRVqncHub1PE9UlMQFs

**_Type 9_**

this means the password will be encrypted when router store it in Run/Start Files using scrypt as the hashing algorithm.

starting from IOS 15.3(3)

Example :
R1(config)#ena algorithm-type scrypt secret cisco

R1(config)#do sh run | i enable

enable secret 9 $9$WnArItcQHW/uuE$x5WTLbu7PbzGDuv0fSwGKS/KURsy5a3WCQckmJp0MbE

Example :
R1(config)# username demo9 algorithm-type scrypt secret cisco

R1# show running-config | inc username

username demo9 secret 9 $9$nhEmQVczB7dqsO$X.HsgL6x1il0RxkOSSvyQYwucySCt7qFm4v7pqCxkKM

Important Notes:

1-If you configure type 8 or type 9 passwords and then downgrade to a release that does not support type 8 and type 9 passwords, you must configure the type 5 passwords before downgrading. If not, you are locked out of the device and a password recovery is required.

2-Starting from IOS 15.3(3)The 4 keyword was deprecated and support for type 8 and type 9 algorithms were added and The warning message for removal of support for the type 4 algorithm was added
tect privileged EXEC mode through policies requiring the 'enabling secret' setting, which enforces a one-way cryptographic hash (MD5).,Configure a strong, enable secret password.
```
hostname(config)#enable secret 9 {ENABLE_SECRET_PASSWORD} 
```,Perform the following to determine enable secret is set:

If the command does not return a result, the enable password is not set.
```
hostname#sh run | incl enable secret 
```,config file,basic,contain,enable secret,any,none,Note: You cannot recover a lost encrypted password. You must clear NVRAM and set a new password.,Critical,TITLE:Restrict Administrator Privileges to Dedicated Administrator Accounts CONTROL:v8 5.4 DESCRIPTION:Restrict administrator privileges to dedicated administrator accounts on enterprise assets. Conduct general computing activities, such as internet browsing, email, and productivity suite use, from the user’s primary, non-privileged account.,TITLE:Ensure the Use of Dedicated Administrative Accounts CONTROL:v7 4.3 DESCRIPTION:Ensure that all users with administrative account access use a dedicated or secondary account for elevated activities. This account should only be used for administrative activities and not internet browsing, email, or similar activities.,BLANK,BLANK,5.4,BLANK,BLANK,X,X,X,4.3,BLANK,BLANK,X,X,X,https://www.cisco.com/c/en/us/td/docs/switches/lan/catalyst9600/software/release/16-12/configuration_guide/sec/b_1612_sec_9600_cg/controlling_switch_access_with_passwords_and_privilege_levels.html,No enable secret password setup by default
1.4,1.4.2,Level 1,Enable 'service password-encryption',Automated,When password encryption is enabled, the encrypted form of the passwords is displayed when a more system:running-config command is entered.,This requires passwords to be encrypted in the configuration file to prevent unauthorized users from learning the passwords just by reading the configuration. When not enabled, many of the device's passwords will be rendered in plain text in the configuration file. This service ensures passwords are rendered as encrypted strings preventing an attacker from easily determining the configured value.,Organizations implementing 'service password-encryption' reduce the risk of unauthorized users learning clear text passwords to Cisco IOS configuration files. However, the algorithm used is not designed to withstand serious analysis and should be treated like clear-text.,Enable password encryption service to protect sensitive access passwords in the device configuration.
```

hostname(config)#service password-encryption
```,Perform the following to determine if a user with an encrypted password is enabled:

Ensure a result that matches the command return
```

hostname#sh run | incl service password-encryption
```,config file,basic,contain,service password-encryption,any,none,Caution: This command does not provide a high level of network security. If you use this command, you should also take additional network security measures.

Note: You cannot recover a lost encrypted password. You must clear NVRAM and set a new password.,Critical,TITLE:Encrypt Sensitive Data at Rest CONTROL:v8 3.11 DESCRIPTION:Encrypt sensitive data at rest on servers, applications, and databases containing sensitive data. Storage-layer encryption, also known as server-side encryption, meets the minimum requirement of this Safeguard. Additional encryption methods may include application-layer encryption, also known as client-side encryption, where access to the data storage device(s) does not permit access to the plain-text data. ,TITLE:Encrypt or Hash all Authentication Credentials CONTROL:v7 16.4 DESCRIPTION:Encrypt or hash with a salt all authentication credentials when stored.,BLANK,BLANK,3.11,BLANK,BLANK,BLANK,X,X,16.4,BLANK,BLANK,BLANK,X,X,http://www.cisco.com/en/US/docs/ios-xml/ios/security/s1/sec-cr-s1.html#GUID-CC0E305A-604E-4A74-8A1A-975556CE5871,Service password encryption is not set by default
1.4,1.4.3,Level 1,Set 'username secret' for all local users,Automated,Username secret password type 5 and enable secret password type 5 must be migrated to the stronger password type 8 or 9. IF a device is upgraded from IOS XE 16.9 or later the type 5 is auto converted to type 9. 

The username secret command provides an additional layer of security over the username password.,Default device configuration does not require strong user authentication potentially enabling unfettered access to an attacker that is able to reach the device. Creating a local account with an encrypted password enforces login authentication and provides a fallback authentication mechanism for configuration in a named method list in a situation where centralized authentication, authorization, and accounting services are unavailable.
The following is the type of encryption the device will allow as of 15.3:
Type 0
this mean the password will not be encrypted when router store it in Run/Start Files
command:
enable password cisco123

Type 4
this mean the password will be encrypted when router store it in Run/Start Files using SHA-256
which apps like Cain can crack but will take long time
command :
enable secret 4 Rv4kArhts7yA2xd8BD2YTVbts
(notice above is not the password string it self but the hash of the password)

this type is deprecated starting from IOS 15.3(3)

Type 5
this mean the password will be encrypted when router store it in Run/Start Files using MD5
which apps like Cain can crack but will take long time
command:
enable secret 5 00271A5307542A02D22842
(notice above is not the password string it self but the hash of the password)
or
enable secret cisco123
(notice above is the password string it self)

Type 7
this mean the password will be encrypted when router store it in Run/Start Files using Vigenere cipher
which any website with type7 reverser can crack it in less than one second
command :
ena password cisco123
service password-encryption

Type 8

this mean the password will be encrypted when router store it in Run/Start Files using PBKDF2-SHA-256

starting from IOS 15.3(3).

Password-Based Key Derivation Function 2 (PBKDF2) with Secure Hash Algorithm, 26-bits (SHA-256) as the hashing algorithm

Example :

R1(config)#enable algorithm-type sha256 secret cisco

R1(config)#do sh run | i enable

enable secret 8 $8$mTj4RZG8N9ZDOk$elY/asfm8kD3iDmkBe3hD2r4xcA/0oWS5V3os.O91u.

Example :

R1(config)# username yasser algorithm-type sha256 secret cisco

R1# show running-config | inc username

username yasser secret 8 $8$dsYGNam3K1SIJO$7nv/35M/qr6t.dVc7UY9zrJDWRVqncHub1PE9UlMQFs

Type 9

this mean the password will be encrypted when router store it in Run/Start Files using scrypt as the hashing algorithm.

starting from IOS 15.3(3)

Example :

R1(config)#ena algorithm-type scrypt secret cisco

R1(config)#do sh run | i enable

enable secret 9 $9$WnArItcQHW/uuE$x5WTLbu7PbzGDuv0fSwGKS/KURsy5a3WCQckmJp0MbE

Example :

R1(config)# username demo9 algorithm-type scrypt secret cisco

R1# show running-config | inc username

username demo9 secret 9 $9$nhEmQVczB7dqsO$X.HsgL6x1il0RxkOSSvyQYwucySCt7qFm4v7pqCxkKM

Important Notes:

1-If you configure type 8 or type 9 passwords and then downgrade to a release that does not support type 8 and type 9 passwords, you must configure the type 5 passwords before downgrading. If not, you are locked out of the device and a password recovery is required.

2-Starting from IOS 15.3(3)The 4 keyword was deprecated and support for type 8 and type 9 algorithms were added and The warning message for removal of support for the type 4 algorithm was added,Organizations implementing 'username secret' across their enterprise reduce the risk of unauthorized users gaining access to Cisco IOS devices by applying a MD5 hash and encrypting user passwords.,Create a local user with an encrypted, complex (not easily guessed) password.
```

hostname(config)#username {{em}LOCAL_USERNAME{/em}} secret {{em}LOCAL_PASSWORD{/em}}
```,Perform the following to determine if a user with an encrypted password is enabled:

If a result does not return with secret, the feature is not enabled
```

 hostname#show run | incl username
```,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,Critical,TITLE:Encrypt Sensitive Data at Rest CONTROL:v8 3.11 DESCRIPTION:Encrypt sensitive data at rest on servers, applications, and databases containing sensitive data. Storage-layer encryption, also known as server-side encryption, meets the minimum requirement of this Safeguard. Additional encryption methods may include application-layer encryption, also known as client-side encryption, where access to the data storage device(s) does not permit access to the plain-text data. ,TITLE:Encrypt or Hash all Authentication Credentials CONTROL:v7 16.4 DESCRIPTION:Encrypt or hash with a salt all authentication credentials when stored.,BLANK,BLANK,3.11,BLANK,BLANK,BLANK,X,X,16.4,BLANK,BLANK,BLANK,X,X,https://www.cisco.com/c/en/us/td/docs/switches/lan/catalyst9600/software/release/16-12/configuration_guide/sec/b_1612_sec_9600_cg/controlling_switch_access_with_passwords_and_privilege_levels.html,No passwords are set by default
1.5,BLANK,BLANK,SNMP Rules,BLANK,Simple Network Management Protocol (SNMP) provides a standards-based interface to manage and monitor network devices. This section provides guidance on the secure configuration of SNMP parameters.

The recommendations in this Section apply to Organizations using SNMP. Organizations using SNMP should review and implement the recommendations in this section.,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK
1.5,1.5.1,Level 1,Set 'no snmp-server' to disable SNMP when unused,Automated,If not in use, disable simple network management protocol (SNMP), read and write access.,SNMP read access allows remote monitoring and management of the device.,Organizations not using SNMP should require all SNMP services to be disabled by running the 'no snmp-server' command.,Disable SNMP read and write access if not in used to monitor and/or manage device.
```
hostname(config)#no snmp-server 
```,Verify the result reads "SNMP agent not enabled"
```
hostname#show snmp community
```,cli,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,Critical,TITLE:Explicitly Not Mapped CONTROL:v8 0.0 DESCRIPTION:Explicitly Not Mapped,TITLE:Ensure Only Approved Ports, Protocols and Services Are Running CONTROL:v7 9.2 DESCRIPTION:Ensure that only network ports, protocols, and services listening on a system with validated business needs, are running on each system.,BLANK,BLANK,0.0,BLANK,BLANK,BLANK,BLANK,BLANK,9.2,BLANK,BLANK,BLANK,X,X,http://www.cisco.com/en/US/docs/ios-xml/ios/snmp/command/nm-snmp-cr-book.html,BLANK
1.5,1.5.2,Level 1,Unset 'private' for 'snmp-server community',Automated,An SNMP community string permits read-only access to all objects.,The default community string "private" is well known. Using easy to guess, well known community string poses a threat that an attacker can effortlessly gain unauthorized access to the device.,To reduce the risk of unauthorized access, Organizations should disable default, easy to guess, settings such as the 'private' setting for snmp-server community.,Disable the default SNMP community string `private`
```
hostname(config)#no snmp-server community {private}
```,Perform the following to determine if the public community string is enabled:

Ensure `private` does not show as a result
```
hostname# show snmp community
```,cli,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,Critical,TITLE:Explicitly Not Mapped CONTROL:v8 0.0 DESCRIPTION:Explicitly Not Mapped,TITLE:Ensure Only Approved Ports, Protocols and Services Are Running CONTROL:v7 9.2 DESCRIPTION:Ensure that only network ports, protocols, and services listening on a system with validated business needs, are running on each system.,BLANK,BLANK,0.0,BLANK,BLANK,BLANK,BLANK,BLANK,9.2,BLANK,BLANK,BLANK,X,X,http://www.cisco.com/en/US/docs/ios-xml/ios/snmp/command/nm-snmp-cr-s2.html#GUID-2F3F13E4-EE81-4590-871D-6AE1043473DE,BLANK
1.5,1.5.3,Level 1,Unset 'public' for 'snmp-server community',Automated,An SNMP community string permits read-only access to all objects.,The default community string "public" is well known. Using easy to guess, well known community string poses a threat that an attacker can effortlessly gain unauthorized access to the device.,To reduce the risk of unauthorized access, Organizations should disable default, easy to guess, settings such as the 'public' setting for snmp-server community.,Disable the default SNMP community string "public"
```

hostname(config)#no snmp-server community {public} 
```,Perform the following to determine if the public community string is enabled: Ensure `public `does not show as a result
```

hostname# show snmp community
```,cli,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,Critical,TITLE:Explicitly Not Mapped CONTROL:v8 0.0 DESCRIPTION:Explicitly Not Mapped,TITLE:Ensure Only Approved Ports, Protocols and Services Are Running CONTROL:v7 9.2 DESCRIPTION:Ensure that only network ports, protocols, and services listening on a system with validated business needs, are running on each system.,BLANK,BLANK,0.0,BLANK,BLANK,BLANK,BLANK,BLANK,9.2,BLANK,BLANK,BLANK,X,X,http://www.cisco.com/en/US/docs/ios-xml/ios/snmp/command/nm-snmp-cr-s2.html#GUID-2F3F13E4-EE81-4590-871D-6AE1043473DE,BLANK
1.5,1.5.4,Level 1,Do not set 'RW' for any 'snmp-server community',Automated,Specifies read-write access. Authorized management stations can both retrieve and modify MIB objects.,Enabling SNMP read-write enables remote management of the device. Unless absolutely necessary, do not allow simple network management protocol (SNMP) write access.,To reduce the risk of unauthorized access, Organizations should disable the SNMP 'write' access for snmp-server community.,Disable SNMP write access.
```

hostname(config)#no snmp-server community {<em>write_community_string</em>} 
```,Perform the following to determine if a read/write community string is enabled:

Verify the result does not show a community string with a "RW"
```

hostname#show run | incl snmp-server community
```,config file,basic,not contain,snmp-server\s+community\s+.*\s+RW,any,none,BLANK,Critical,TITLE:Explicitly Not Mapped CONTROL:v8 0.0 DESCRIPTION:Explicitly Not Mapped,TITLE:Ensure Only Approved Ports, Protocols and Services Are Running CONTROL:v7 9.2 DESCRIPTION:Ensure that only network ports, protocols, and services listening on a system with validated business needs, are running on each system.,BLANK,BLANK,0.0,BLANK,BLANK,BLANK,BLANK,BLANK,9.2,BLANK,BLANK,BLANK,X,X,http://www.cisco.com/en/US/docs/ios-xml/ios/snmp/command/nm-snmp-cr-s2.html#GUID-2F3F13E4-EE81-4590-871D-6AE1043473DE,BLANK
1.5,1.5.5,Level 1,Set the ACL for each 'snmp-server community',Automated,This feature specifies a list of IP addresses that are allowed to use the community string to gain access to the SNMP agent.,If ACLs are not applied, then anyone with a valid SNMP community string can potentially monitor and manage the router. An ACL should be defined and applied for all SNMP access to limit access to a small number of authorized management stations segmented in a trusted management zone. If possible, use SNMPv3 which uses authentication, authorization, and data privatization (encryption).,To reduce the risk of unauthorized access, Organizations should enable access control lists for all snmp-server communities and restrict the access to appropriate trusted management zones. If possible, implement SNMPv3 to apply authentication, authorization, and data privatization (encryption) for additional benefits to the organization.,Configure authorized SNMP community string and restrict access to authorized management systems.
```

hostname(config)#snmp-server community <<em>community_string</em>> ro {<em>snmp_access-list_number | 
<span>snmp_access-list_name</span></em><span>}</span>
```,Perform the following to determine if an ACL is enabled:

Verify the result shows a number after the community string
```

hostname#show run | incl snmp-server community
```,config file,basic,contain,snmp-server community public RO\s+(\d+)
,any,none,BLANK,Critical,TITLE:Establish and Maintain Dedicated Computing Resources for All Administrative Work CONTROL:v8 12.8 DESCRIPTION:Establish and maintain dedicated computing resources, either physically or logically separated, for all administrative tasks or tasks requiring administrative access. The computing resources should be segmented from the enterprise's primary network and not be allowed internet access.,TITLE:Manage Network Infrastructure Through a Dedicated Network CONTROL:v7 11.7 DESCRIPTION:Manage the network infrastructure across network connections that are separated from the business use of that network, relying on separate VLANs or, preferably, on entirely different physical connectivity for management sessions for network devices.,BLANK,BLANK,12.8,BLANK,BLANK,BLANK,BLANK,X,11.7,BLANK,BLANK,BLANK,X,X,http://www.cisco.com/en/US/docs/ios-xml/ios/snmp/command/nm-snmp-cr-s2.html#GUID-2F3F13E4-EE81-4590-871D-6AE1043473DE,No ACL is set for SNMP
1.5,1.5.6,Level 1,Create an 'access-list' for use with SNMP,Automated,You can use access lists to control the transmission of packets on an interface, control Simple Network Management Protocol (SNMP) access, and restrict the contents of routing updates. The Cisco IOS software stops checking the extended access list after a match occurs.,SNMP ACLs control what addresses are authorized to manage and monitor the device via SNMP. If ACLs are not applied, then anyone with a valid SNMP community string may monitor and manage the router. An ACL should be defined and applied for all SNMP community strings to limit access to a small number of authorized management stations segmented in a trusted management zone.,BLANK,Configure SNMP ACL for restricting access to the device from authorized management stations segmented in a trusted management zone.
```

hostname(config)#access-list <<em>snmp_acl_number</em>> permit <<em>snmp_access-list</em>>
hostname(config)#access-list deny any log 
```,Perform the following to determine if the ACL is created:

Verify you the appropriate access-list definitions
```

hostname#sh ip access-list <<em>snmp_acl_number</em>> 
```,cli,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,Critical,TITLE:Establish and Maintain Dedicated Computing Resources for All Administrative Work CONTROL:v8 12.8 DESCRIPTION:Establish and maintain dedicated computing resources, either physically or logically separated, for all administrative tasks or tasks requiring administrative access. The computing resources should be segmented from the enterprise's primary network and not be allowed internet access.,TITLE:Manage Network Infrastructure Through a Dedicated Network CONTROL:v7 11.7 DESCRIPTION:Manage the network infrastructure across network connections that are separated from the business use of that network, relying on separate VLANs or, preferably, on entirely different physical connectivity for management sessions for network devices.,BLANK,BLANK,12.8,BLANK,BLANK,BLANK,BLANK,X,11.7,BLANK,BLANK,BLANK,X,X,http://www.cisco.com/en/US/docs/ios-xml/ios/security/a1/sec-cr-a2.html#GUID-9EA733A3-1788-4882-B8C3-AB0A2949120C,SNMP does not use an access list.
1.5,1.5.7,Level 1,Set 'snmp-server host' when using SNMP,Automated,SNMP notifications can be sent as traps to authorized management systems.,If SNMP is enabled for device management and device alerts are required, then ensure the device is configured to submit traps only to authorize management systems.,Organizations using SNMP should restrict sending SNMP messages only to explicitly named systems to reduce unauthorized access.,Configure authorized SNMP trap community string and restrict sending messages to authorized management systems.
```

hostname(config)#snmp-server host {ip_address} {trap_community_string} {notification-type} 
```,Perform the following to determine if SNMP traps are enabled:

If the command returns configuration values, then SNMP is enabled.
```

hostname#show run | incl snmp-server
```,config file,basic,contain,snmp-server host,any,none,BLANK,Critical,TITLE:Establish and Maintain Dedicated Computing Resources for All Administrative Work CONTROL:v8 12.8 DESCRIPTION:Establish and maintain dedicated computing resources, either physically or logically separated, for all administrative tasks or tasks requiring administrative access. The computing resources should be segmented from the enterprise's primary network and not be allowed internet access.,TITLE:Manage Network Infrastructure Through a Dedicated Network CONTROL:v7 11.7 DESCRIPTION:Manage the network infrastructure across network connections that are separated from the business use of that network, relying on separate VLANs or, preferably, on entirely different physical connectivity for management sessions for network devices.,BLANK,BLANK,12.8,BLANK,BLANK,BLANK,BLANK,X,11.7,BLANK,BLANK,BLANK,X,X,http://www.cisco.com/en/US/docs/ios-xml/ios/snmp/command/nm-snmp-cr-s5.html#GUID-D84B2AB5-6485-4A23-8C26-73E50F73EE61,A recipient is not specified to receive notifications.
1.5,1.5.8,Level 1,Set 'snmp-server enable traps snmp',Automated,SNMP notifications can be sent as traps to authorized management systems.,SNMP has the ability to submit traps .,Organizations using SNMP should restrict trap types only to explicitly named traps to reduce unintended traffic. Enabling SNMP traps without specifying trap type will enable all SNMP trap types.,Enable SNMP traps.
```
hostname(config)#snmp-server enable traps snmp authentication linkup linkdown coldstart 
```,Perform the following to determine if SNMP traps are enabled:

If the command returns configuration values, then SNMP is enabled.
```

hostname#show run | incl snmp-server
```,config file,basic,contain,snmp-server enable traps,any,none,BLANK,Critical,TITLE:Establish and Maintain Dedicated Computing Resources for All Administrative Work CONTROL:v8 12.8 DESCRIPTION:Establish and maintain dedicated computing resources, either physically or logically separated, for all administrative tasks or tasks requiring administrative access. The computing resources should be segmented from the enterprise's primary network and not be allowed internet access.,TITLE:Manage Network Infrastructure Through a Dedicated Network CONTROL:v7 11.7 DESCRIPTION:Manage the network infrastructure across network connections that are separated from the business use of that network, relying on separate VLANs or, preferably, on entirely different physical connectivity for management sessions for network devices.,BLANK,BLANK,12.8,BLANK,BLANK,BLANK,BLANK,X,11.7,BLANK,BLANK,BLANK,X,X,http://www.cisco.com/en/US/docs/ios-xml/ios/snmp/command/nm-snmp-cr-s3.html#GUID-EB3EB677-A355-42C6-A139-85BA30810C54,SNMP notifications are disabled.
1.5,1.5.9,Level 2,Set 'priv' for each 'snmp-server group' using SNMPv3,Automated,Specifies authentication of a packet with encryption when using SNMPv3,SNMPv3 provides much improved security over previous versions by offering options for Authentication and Encryption of messages. When configuring a user for SNMPv3 you have the option of using a range of encryption schemes, or no encryption at all, to protect messages in transit. AES128 is the minimum strength encryption method that should be deployed.,Organizations using SNMP can significantly reduce the risks of unauthorized access by using the 'snmp-server group v3 priv' setting to encrypt messages in transit.,For each SNMPv3 group created on your router add privacy options by issuing the following command...
```

hostname(config)#snmp-server group {<em>group_name</em>} v3 priv
```,Verify the result show the appropriate group name and security model
```

hostname#show snmp group
```,config file,basic,contain,.*snmp-server group.*v3\s*priv,any,none,BLANK,Critical,TITLE:Explicitly Not Mapped CONTROL:v8 0.0 DESCRIPTION:Explicitly Not Mapped,TITLE:Explicitly Not Mapped CONTROL:v7 0.0 DESCRIPTION:Explicitly Not Mapped,BLANK,BLANK,0.0,BLANK,BLANK,BLANK,BLANK,BLANK,0.0,BLANK,BLANK,BLANK,BLANK,BLANK,http://www.cisco.com/en/US/docs/ios-xml/ios/snmp/command/nm-snmp-cr-s5.html#GUID-56E87D02-C56F-4E2D-A5C8-617E31740C3F,No SNMP server groups are configured.
1.5,1.5.10,Level 2,Require 'aes 128' as minimum for 'snmp-server user' when using SNMPv3,Automated,Specify the use of a minimum of 128-bit AES algorithm for encryption when using SNMPv3.,SNMPv3 provides much improved security over previous versions by offering options for Authentication and Encryption of messages. When configuring a user for SNMPv3 you have the option of using a range of encryption schemes, or no encryption at all, to protect messages in transit. AES128 is the minimum strength encryption method that should be deployed.,Organizations using SNMP can significantly reduce the risks of unauthorized access by using the 'snmp-server user' setting with appropriate authentication and privacy protocols to encrypt messages in transit.,For each SNMPv3 user created on your router add privacy options by issuing the following command.
```

hostname(config)#snmp-server user {user_name} {group_name} v3 auth sha {auth_password} priv aes 128 {priv_password} {acl_name_or_number}
```,Verify the result show the appropriate user name and security settings
```

hostname#show snmp user
```,config file,basic,contain,.*snmp-server user.*v3 auth sha.*priv aes 128.*,any,none,BLANK,Critical,TITLE:Encrypt Sensitive Data in Transit CONTROL:v8 3.10 DESCRIPTION:Encrypt sensitive data in transit. Example implementations can include: Transport Layer Security (TLS) and Open Secure Shell (OpenSSH).,TITLE:Use Only Standardized and Extensively Reviewed Encryption Algorithms CONTROL:v7 18.5 DESCRIPTION:Use only standardized and extensively reviewed encryption algorithms.,BLANK,BLANK,3.10,BLANK,BLANK,BLANK,X,X,18.5,BLANK,BLANK,BLANK,X,X,http://www.cisco.com/en/US/docs/ios-xml/ios/snmp/command/nm-snmp-cr-s5.html#GUID-4EED4031-E723-4B84-9BBF-610C3CF60E31,SNMP username as not set by default.
2,BLANK,BLANK,Control Plane,BLANK,The control plane covers monitoring, route table updates, and generally the dynamic operation of the router. Services, settings, and data streams that support and document the operation, traffic handling, and dynamic status of the router. Examples of control plane services include: logging (e.g. Syslog), routing protocols, status protocols like CDP and HSRP, network topology protocols like STP, and traffic security control protocols like IKE. Network control protocols like ICMP, NTP, ARP, and IGMP directed to or sent by the router itself also fall into this area.,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK
2.1,BLANK,BLANK,Global Service Rules,BLANK,Rules in the global service class enforce server and service controls that protect against attacks or expose the device to exploitation.,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK
2.1,2.1.2,Level 1,Set 'no cdp run',Automated,Disable Cisco Discovery Protocol (CDP) service at device level.,The Cisco Discovery Protocol is a proprietary protocol that Cisco devices use to identify each other on a LAN segment. It is useful only in network monitoring and troubleshooting situations but is considered a security risk because of the amount of information provided from queries. In addition, there have been published denial-of-service (DoS) attacks that use CDP. CDP should be completely disabled unless necessary.,To reduce the risk of unauthorized access, organizations should implement a security policy restricting network protocols and explicitly require disabling all insecure or unnecessary protocols.,Disable Cisco Discovery Protocol (CDP) service globally.
```

hostname(config)#no cdp run
```,Perform the following to determine if CDP is enabled:

Verify the result shows "CDP is not enabled"
```

hostname#show cdp
```,cli,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,High,TITLE:Explicitly Not Mapped CONTROL:v8 0.0 DESCRIPTION:Explicitly Not Mapped,TITLE:Ensure Only Approved Ports, Protocols and Services Are Running CONTROL:v7 9.2 DESCRIPTION:Ensure that only network ports, protocols, and services listening on a system with validated business needs, are running on each system.,BLANK,BLANK,0.0,BLANK,BLANK,BLANK,BLANK,BLANK,9.2,BLANK,BLANK,BLANK,X,X,http://www.cisco.com/en/US/docs/ios-xml/ios/cdp/command/cdp-cr-a1.html#GUID-E006FAC8-417E-4C3F-B732-4D47B0447750,Enabled on all platforms except the Cisco 10000 Series Edge Services Router
2.1,2.1.3,Level 1,Set 'no ip bootp server',Automated,Disable the Bootstrap Protocol (BOOTP) service on your routing device.,BootP allows a router to issue IP addresses. This should be disabled unless there is a specific requirement.,To reduce the risk of unauthorized access, organizations should implement a security policy restricting network protocols and explicitly require disabling all insecure or unnecessary protocols such as 'ip bootp server'.,Disable the bootp server.
```

hostname(config)#ip dhcp bootp ignore
```,Perform the following to determine if bootp is enabled:

Verify a "no ip bootp server" result returns
```

hostname#show run | incl bootp
```,config file,basic,contain,.*ip dhcp bootp ignore.*,any,none,BLANK,High,TITLE:Explicitly Not Mapped CONTROL:v8 0.0 DESCRIPTION:Explicitly Not Mapped,TITLE:Ensure Only Approved Ports, Protocols and Services Are Running CONTROL:v7 9.2 DESCRIPTION:Ensure that only network ports, protocols, and services listening on a system with validated business needs, are running on each system.,BLANK,BLANK,0.0,BLANK,BLANK,BLANK,BLANK,BLANK,9.2,BLANK,BLANK,BLANK,X,X,Cisco IOS software receives Cisco Discovery Protocol information,Enabled
2.1,2.1.4,Level 1,Set 'no service dhcp',Automated,Disable the Dynamic Host Configuration Protocol (DHCP) server and relay agent features on your router.,The DHCP server supplies automatic configuration parameters, such as dynamic IP address, to requesting systems. A dedicated server located in a secured management zone should be used to provide DHCP services instead. Attackers can potentially be used for denial-of-service (DoS) attacks.,To reduce the risk of unauthorized access, organizations should implement a security policy restricting network protocols and explicitly require disabling all insecure or unnecessary protocols such as the Dynamic Host Configuration Protocol (DHCP).,Disable the DHCP server.
```

hostname(config)#<strong>no service dhcp</strong>
```,Perform the following to determine if the DHCP service is enabled:

Verify no result returns
```

hostname#show run | incl dhcp
```,config file,basic,contain,.*no service dhcp.*,any,none,BLANK,High,TITLE:Explicitly Not Mapped CONTROL:v8 0.0 DESCRIPTION:Explicitly Not Mapped,TITLE:Ensure Only Approved Ports, Protocols and Services Are Running CONTROL:v7 9.2 DESCRIPTION:Ensure that only network ports, protocols, and services listening on a system with validated business needs, are running on each system.,BLANK,BLANK,0.0,BLANK,BLANK,BLANK,BLANK,BLANK,9.2,BLANK,BLANK,BLANK,X,X,http://www.cisco.com/en/US/docs/ios-xml/ios/ipaddr/command/ipaddr-r1.html#GUID-1516B259-AA28-4839-B968-8DDBF0B382F6,Enabled by default, but also requires a DHCP pool to be set to activate the DHCP server.
2.1,2.1.5,Level 1,Set 'no ip identd',Automated,Disable the identification (identd) server.,Identification protocol enables identifying a user's transmission control protocol (TCP) session. This information disclosure could potentially provide an attacker with information about users.,To reduce the risk of unauthorized access, organizations should implement a security policy restricting network protocols and explicitly require disabling all insecure or unnecessary protocols such as the identification protocol (identd).,Disable the ident server.
```
hostname(config)#no ip identd
```,Perform the following to determine if identd is enabled:

Verify no result returns
```
hostname#show run | incl identd
```,config file,basic,not contain,.*identd.*,any,none,BLANK,High,TITLE:Explicitly Not Mapped CONTROL:v8 0.0 DESCRIPTION:Explicitly Not Mapped,TITLE:Ensure Only Approved Ports, Protocols and Services Are Running CONTROL:v7 9.2 DESCRIPTION:Ensure that only network ports, protocols, and services listening on a system with validated business needs, are running on each system.,BLANK,BLANK,0.0,BLANK,BLANK,BLANK,BLANK,BLANK,9.2,BLANK,BLANK,BLANK,X,X,http://www.cisco.com/en/US/docs/solutions/Enterprise/Security/Baseline_Security/sec_chap4.html#wp1056539,Disabled by default
2.1,2.1.6,Level 1,Set 'service tcp-keepalives-in',Automated,Generate keepalive packets on idle incoming network connections.,Stale connections use resources and could potentially be hijacked to gain illegitimate access. The TCP keepalives-in service generates keepalive packets on idle incoming network connections (initiated by remote host). This service allows the device to detect when the remote host fails and drop the session. If enabled, keepalives are sent once per minute on idle connections. The connection is closed within five minutes if no keepalives are received or immediately if the host replies with a reset packet.,To reduce the risk of unauthorized access, organizations should implement a security policy restricting how long to allow terminated sessions and enforce this policy through the use of 'tcp-keepalives-in' command.,Enable TCP keepalives-in service:
```

hostname(config)#service tcp-keepalives-in
```,Perform the following to determine if the feature is enabled:

Verify a command string result returns
```

hostname#show run | incl service tcp
```,config file,basic,contain,.*service tcp-keepalives-in.*,any,none,BLANK,High,TITLE:Explicitly Not Mapped CONTROL:v8 0.0 DESCRIPTION:Explicitly Not Mapped,TITLE:Ensure Only Approved Ports, Protocols and Services Are Running CONTROL:v7 9.2 DESCRIPTION:Ensure that only network ports, protocols, and services listening on a system with validated business needs, are running on each system.,BLANK,BLANK,0.0,BLANK,BLANK,BLANK,BLANK,BLANK,9.2,BLANK,BLANK,BLANK,X,X,http://www.cisco.com/en/US/docs/ios-xml/ios/fundamentals/command/R_through_setup.html#GUID-1489ABA3-2428-4A64-B252-296A035DB85E,Disabled by default.
2.1,2.1.7,Level 1,Set 'service tcp-keepalives-out',Automated,Generate keepalive packets on idle outgoing network connections.,Stale connections use resources and could potentially be hijacked to gain illegitimate access. The TCP keepalives-in service generates keepalive packets on idle incoming network connections (initiated by remote host). This service allows the device to detect when the remote host fails and drop the session. If enabled, keepalives are sent once per minute on idle connections. The closes connection is closed within five minutes if no keepalives are received or immediately if the host replies with a reset packet.,To reduce the risk of unauthorized access, organizations should implement a security policy restricting how long to allow terminated sessions and enforce this policy through the use of 'tcp-keepalives-out' command.,Enable TCP keepalives-out service:
```

hostname(config)#service tcp-keepalives-out
```,Perform the following to determine if the feature is enabled:

Verify a command string result returns
```

hostname#show run | incl service tcp
```,config file,basic,contain,.*service tcp-keepalives-out.*,any,none,BLANK,High,TITLE:Explicitly Not Mapped CONTROL:v8 0.0 DESCRIPTION:Explicitly Not Mapped,TITLE:Ensure Only Approved Ports, Protocols and Services Are Running CONTROL:v7 9.2 DESCRIPTION:Ensure that only network ports, protocols, and services listening on a system with validated business needs, are running on each system.,BLANK,BLANK,0.0,BLANK,BLANK,BLANK,BLANK,BLANK,9.2,BLANK,BLANK,BLANK,X,X,http://www.cisco.com/en/US/docs/ios-xml/ios/fundamentals/command/R_through_setup.html#GUID-9321ECDC-6284-4BF6-BA4A-9CEEF5F993E5,Disabled by default.
2.1,2.1.8,Level 1,Set 'no service pad',Automated,Disable X.25 Packet Assembler/Disassembler (PAD) service.,If the PAD service is not necessary, disable the service to prevent intruders from accessing the X.25 PAD command set on the router.,To reduce the risk of unauthorized access, organizations should implement a security policy restricting unnecessary services such as the 'PAD' service.,Disable the PAD service.
```

hostname(config)#no service pad
```,Perform the following to determine if the feature is disabled:

Verify no result returns
```

hostname#show run | incl service pad
```,config file,basic,contain,.*no service pad.*,any,none,BLANK,High,TITLE:Explicitly Not Mapped CONTROL:v8 0.0 DESCRIPTION:Explicitly Not Mapped,TITLE:Ensure Only Approved Ports, Protocols and Services Are Running CONTROL:v7 9.2 DESCRIPTION:Ensure that only network ports, protocols, and services listening on a system with validated business needs, are running on each system.,BLANK,BLANK,0.0,BLANK,BLANK,BLANK,BLANK,BLANK,9.2,BLANK,BLANK,BLANK,X,X,http://www.cisco.com/en/US/docs/ios-xml/ios/wan/command/wan-s1.html#GUID-C5497B77-3FD4-4D2F-AB08-1317D5F5473B,Enabled by default.
2.1.1,BLANK,BLANK,Setup SSH,BLANK,Ensure use of SSH remote console sessions to Cisco routers.,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK
2.1.1,2.1.1.2,Level 1,Set version 2 for 'ip ssh version',Automated,Specify the version of Secure Shell (SSH) to be run on a router,SSH Version 1 has been subject to a number of serious vulnerabilities and is no longer considered to be a secure protocol, resulting in the adoption of SSH Version 2 as an Internet Standard in 2006.

Cisco routers support both versions, but due to the weakness of SSH Version 1 only the later standard should be used.,To reduce the risk of unauthorized access, organizations should implement a security policy to review their current protocols to ensure the most secure protocol versions are in use.,Configure the router to use SSH version 2
```

hostname(config)#ip ssh version 2
```,Perform the following to determine if SSH version 2 is configured:

Verify that SSH version 2 is configured properly.
```

hostname#sh ip ssh
```,cli,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,Critical,TITLE:Explicitly Not Mapped CONTROL:v8 0.0 DESCRIPTION:Explicitly Not Mapped,TITLE:Explicitly Not Mapped CONTROL:v7 0.0 DESCRIPTION:Explicitly Not Mapped,BLANK,BLANK,0.0,BLANK,BLANK,BLANK,BLANK,BLANK,0.0,BLANK,BLANK,BLANK,BLANK,BLANK,http://www.cisco.com/en/US/docs/ios-xml/ios/security/d1/sec-cr-i3.html#GUID-170AECF1-4B5B-462A-8CC8-999DEDC45C21,SSH is not enabled by default. When enabled, SSH operates in compatibility mode (versions 1 and 2 supported).
2.1.1.1,BLANK,BLANK,Configure Prerequisites for the SSH Service,BLANK,[This space intentionally left blank],BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK
2.1.1.1,2.1.1.1.1,Level 1,Set the 'hostname',Automated,The hostname is used in prompts and default configuration filenames.,The domain name is prerequisite for setting up SSH.,Organizations should plan the enterprise network and identify an appropriate host name for each router.,Configure an appropriate host name for the router.
```

hostname(config)#hostname {<em>router_name</em>}
```,Perform the following to determine if the local time zone is configured:

Verify the result shows the summer-time recurrence is configured properly.
```

hostname#sh run | incl hostname
```,config file,basic,contain,\s*hostname\s*\S+,any,none,BLANK,High,TITLE:Explicitly Not Mapped CONTROL:v8 0.0 DESCRIPTION:Explicitly Not Mapped,TITLE:Explicitly Not Mapped CONTROL:v7 0.0 DESCRIPTION:Explicitly Not Mapped,BLANK,BLANK,0.0,BLANK,BLANK,BLANK,BLANK,BLANK,0.0,BLANK,BLANK,BLANK,BLANK,BLANK,http://www.cisco.com/en/US/docs/ios-xml/ios/fundamentals/command/F_through_K.html#GUID-F3349988-EC16-484A-BE81-4C40110E6625,The default hostname is Router.
2.1.1.1,2.1.1.1.2,Level 1,Set the 'ip domain-name',Automated,Define a default domain name that the Cisco IOS software uses to complete unqualified hostnames,The domain name is a prerequisite for setting up SSH.,Organizations should plan the enterprise network and identify an appropriate domain name for the router.,Configure an appropriate domain name for the router.
```

hostname (config)#ip domain-name {<em>domain-name</em>}
```,Perform the following to determine if the domain name is configured:

Verify the domain name is configured properly.
```

hostname#sh run | incl domain-name
```,config file,basic,contain,\s*ip\s+domain(-|\s+)name\s+\S+,any,none,BLANK,High,TITLE:Explicitly Not Mapped CONTROL:v8 0.0 DESCRIPTION:Explicitly Not Mapped,TITLE:Explicitly Not Mapped CONTROL:v7 0.0 DESCRIPTION:Explicitly Not Mapped,BLANK,BLANK,0.0,BLANK,BLANK,BLANK,BLANK,BLANK,0.0,BLANK,BLANK,BLANK,BLANK,BLANK,http://www.cisco.com/en/US/docs/ios-xml/ios/ipaddr/command/ipaddr-i3.html#GUID-A706D62B-9170-45CE-A2C2-7B2052BE2CAB,No domain is set.
2.1.1.1,2.1.1.1.3,Level 1,Set 'modulus' to greater than or equal to 2048 for 'crypto key generate rsa',Automated,Use this command to generate RSA key pairs for your Cisco device.

RSA keys are generated in pairs--one public RSA key and one private RSA key.,An RSA key pair is a prerequisite for setting up SSH and should be at least 2048 bits.

NOTE: IOS does NOT display the modulus bit value in the Audit Procedure.,Organizations should plan and implement enterprise network cryptography and generate an appropriate RSA key pairs, such as 'modulus', greater than or equal to 2048.,Generate an RSA key pair for the router.
```

hostname(config)#crypto key generate rsa general-keys modulus <em>2048</em>
```,Perform the following to determine if the RSA key pair is configured:
```

 hostname#sh crypto key mypubkey rsa
```,cli,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,High,TITLE:Leverage Vetted Modules or Services for Application Security Components CONTROL:v8 16.11 DESCRIPTION:Leverage vetted modules or services for application security components, such as identity management, encryption, and auditing and logging. Using platform features in critical security functions will reduce developers’ workload and minimize the likelihood of design or implementation errors. Modern operating systems provide effective mechanisms for identification, authentication, and authorization and make those mechanisms available to applications. Use only standardized, currently accepted, and extensively reviewed encryption algorithms. Operating systems also provide mechanisms to create and maintain secure audit logs.,TITLE:Use Only Standardized and Extensively Reviewed Encryption Algorithms CONTROL:v7 18.5 DESCRIPTION:Use only standardized and extensively reviewed encryption algorithms.,BLANK,BLANK,16.11,BLANK,BLANK,BLANK,X,X,18.5,BLANK,BLANK,BLANK,X,X,http://www.cisco.com/en/US/docs/ios-xml/ios/security/a1/sec-cr-c4.html#GUID-2AECF701-D54A-404E-9614-D3AAB049BC13,RSA key pairs do not exist.
2.1.1.1,2.1.1.1.4,Level 1,Set 'seconds' for 'ip ssh timeout' for 60 seconds or less,Automated,The time interval that the router waits for the SSH client to respond before disconnecting an uncompleted login attempt.,This reduces the risk of an administrator leaving an authenticated session logged in for an extended period of time.,Organizations should implement a security policy requiring minimum timeout settings for all network administrators and enforce the policy through the 'ip ssh timeout' command.,Configure the SSH timeout
```

hostname(config)#ip ssh time-out [<em>60</em>] 
```,Perform the following to determine if the SSH timeout is configured:

Verify the timeout is configured properly.
```

hostname#sh ip ssh
```,cli,BLANK,BLANK,BLANK,BLANK,BLANK,This cannot exceed 120 seconds.,High,TITLE:Configure Automatic Session Locking on Enterprise Assets CONTROL:v8 4.3 DESCRIPTION:Configure automatic session locking on enterprise assets after a defined period of inactivity. For general purpose operating systems, the period must not exceed 15 minutes. For mobile end-user devices, the period must not exceed 2 minutes.,TITLE:Lock Workstation Sessions After Inactivity CONTROL:v7 16.11 DESCRIPTION:Automatically lock workstation sessions after a standard period of inactivity.,BLANK,BLANK,4.3,BLANK,BLANK,X,X,X,16.11,BLANK,BLANK,X,X,X,http://www.cisco.com/en/US/docs/ios-xml/ios/security/d1/sec-cr-i3.html#GUID-5BAC7A2B-0A25-400F-AEE9-C22AE08513C6,SSH in not enabled by default.
2.1.1.1,2.1.1.1.5,Level 1,Set maximum value for 'ip ssh authentication-retries',Automated,The number of retries before the SSH login session disconnects.,This limits the number of times an unauthorized user can attempt a password without having to establish a new SSH login attempt. This reduces the potential for success during online brute force attacks by limiting the number of login attempts per SSH connection.,Organizations should implement a security policy limiting the number of authentication attempts for network administrators and enforce the policy through the 'ip ssh authentication-retries' command.,Configure the SSH timeout: 3 or less
```

hostname(config)#ip ssh authentication-retries [<em>3</em>]
```,Perform the following to determine if SSH authentication retries is configured:

Verify the authentication retries is configured properly.
```

hostname#sh ip ssh
```,cli,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,High,TITLE:Explicitly Not Mapped CONTROL:v8 0.0 DESCRIPTION:Explicitly Not Mapped,TITLE:Explicitly Not Mapped CONTROL:v7 0.0 DESCRIPTION:Explicitly Not Mapped,BLANK,BLANK,0.0,BLANK,BLANK,BLANK,BLANK,BLANK,0.0,BLANK,BLANK,BLANK,BLANK,BLANK,http://www.cisco.com/en/US/docs/ios-xml/ios/security/d1/sec-cr-i3.html#GUID-5BAC7A2B-0A25-400F-AEE9-C22AE08513C6,SSH is not enabled by default. When set, the default value is 3.
2.2,BLANK,BLANK,Logging Rules,BLANK,Rules in the logging class enforce controls that provide a record of system activity and events.,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK
2.2,2.2.1,Level 1,Set 'logging enable',Automated,Enable logging of system messages.,Logging provides a chronological record of activities on the Cisco device and allows monitoring of both operational and security related events.,Enabling the Cisco IOS 'logging enable' command enforces the monitoring of technology risks for the organizations' network devices.,Enable system logging.
```

hostname(config)#archive
hostname(config-archive)#log config
hostname(config-archive-log-cfg)#logging enable
hostname(config-archive-log-cfg)#end
```,Perform the following to determine if the feature is enabled:

Verify no result returns
```

hostname#show run | i logging host
```,config file,basic,contain,\s*logging host .*,any,none,BLANK,Critical,TITLE:Collect Detailed Audit Logs CONTROL:v8 8.5 DESCRIPTION:Configure detailed audit logging for enterprise assets containing sensitive data. Include event source, date, username, timestamp, source addresses, destination addresses, and other useful elements that could assist in a forensic investigation.,TITLE:Enable Detailed Logging CONTROL:v7 6.3 DESCRIPTION:Enable system logging to include detailed information such as an event source, date, user, timestamp, source addresses, destination addresses, and other useful elements.,BLANK,BLANK,8.5,BLANK,BLANK,BLANK,X,X,6.3,BLANK,BLANK,BLANK,X,X,https://community.cisco.com/t5/networking-knowledge-base/how-to-configure-logging-in-cisco-ios/ta-p/3132434,Logging is not enabled/
2.2,2.2.2,Level 1,Set 'buffer size' for 'logging buffered',Automated,Enable system message logging to a local buffer.,The device can copy and store log messages to an internal memory buffer. The buffered data is available only from a router exec or enabled exec session. This form of logging is useful for debugging and monitoring when logged in to a router.,Data forensics is effective for managing technology risks and an organization can enforce such policies by enabling the 'logging buffered' command.,Configure buffered logging (with minimum size). Recommended size is 64000.
```

hostname(config)#logging buffered [<em>log_buffer_size</em>]
```,Perform the following to determine if the feature is enabled:

Verify a command string result returns
```

hostname#show run | incl logging buffered
```,config file,basic,contain,\s*logging buffered \d+.*,any,none,BLANK,Critical,TITLE:Collect Detailed Audit Logs CONTROL:v8 8.5 DESCRIPTION:Configure detailed audit logging for enterprise assets containing sensitive data. Include event source, date, username, timestamp, source addresses, destination addresses, and other useful elements that could assist in a forensic investigation.,TITLE:Enable Detailed Logging CONTROL:v7 6.3 DESCRIPTION:Enable system logging to include detailed information such as an event source, date, user, timestamp, source addresses, destination addresses, and other useful elements.,BLANK,BLANK,8.5,BLANK,BLANK,BLANK,X,X,6.3,BLANK,BLANK,BLANK,X,X,http://www.cisco.com/en/US/docs/ios/netmgmt/command/reference/nm_09.html#wp1060051,No logging buffer is set by default
2.2,2.2.3,Level 1,Set 'logging console critical',Automated,Verify logging to device console is enabled and limited to a rational severity level to avoid impacting system performance and management.,This configuration determines the severity of messages that will generate console messages. Logging to console should be limited only to those messages required for immediate troubleshooting while logged into the device. This form of logging is not persistent; messages printed to the console are not stored by the router. Console logging is handy for operators when they use the console.,Logging critical messages at the console is important for an organization managing technology risk. The 'logging console' command should capture appropriate severity messages to be effective.,Configure console logging level.
```

hostname(config)#logging console critical
```,Perform the following to determine if the feature is enabled:

Verify a command string result returns
```

hostname#show run | incl logging console
```,config file,basic,contain,\s*logging console critical.*,any,none,The console is a slow display device. In message storms some logging messages may be silently dropped when the console queue becomes full. Set severity levels accordingly.,Critical,TITLE:Collect Detailed Audit Logs CONTROL:v8 8.5 DESCRIPTION:Configure detailed audit logging for enterprise assets containing sensitive data. Include event source, date, username, timestamp, source addresses, destination addresses, and other useful elements that could assist in a forensic investigation.,TITLE:Enable Detailed Logging CONTROL:v7 6.3 DESCRIPTION:Enable system logging to include detailed information such as an event source, date, user, timestamp, source addresses, destination addresses, and other useful elements.,BLANK,BLANK,8.5,BLANK,BLANK,BLANK,X,X,6.3,BLANK,BLANK,BLANK,X,X,BLANK,Tthe default is to log all messages
2.2,2.2.4,Level 1,Set IP address for 'logging host',Automated,Log system messages and debug output to a remote host.,Cisco routers can send their log messages to a Unix-style Syslog service. A syslog service simply accepts messages and stores them in files or prints them according to a simple configuration file. This form of logging is best because it can provide protected long-term storage for logs (the devices internal logging buffer has limited capacity to store events.) In addition, logging to an external system is highly recommended or required by most security standards. If desired or required by policy, law and/or regulation, enable a second syslog server for redundancy.,Logging is an important process for an organization managing technology risk. The 'logging host' command sets the IP address of the logging host and enforces the logging process.,Designate one or more syslog servers by IP address.
```

hostname(config)#logging host {syslog_server}
```,Perform the following to determine if a syslog server is enabled:

Verify one or more IP address(es) returns
```

hostname#sh log | incl logging host
```,cli,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,Critical,TITLE:Centralize Security Event Alerting CONTROL:v8 13.1 DESCRIPTION:Centralize security event alerting across enterprise assets for log correlation and analysis. Best practice implementation requires the use of a SIEM, which includes vendor-defined event correlation alerts. A log analytics platform configured with security-relevant correlation alerts also satisfies this Safeguard.,TITLE:Tune Security Event Alerting Thresholds CONTROL:v8 13.11 DESCRIPTION:Tune security event alerting thresholds monthly, or more frequently.,TITLE:Deploy SIEM or Log Analytic tool CONTROL:v7 6.6 DESCRIPTION:Deploy Security Information and Event Management (SIEM) or log analytic tool for log correlation and analysis.,TITLE:Regularly Tune SIEM CONTROL:v7 6.8 DESCRIPTION:On a regular basis, tune your SIEM system to better identify actionable events and decrease event noise.,13.1,13.11,BLANK,BLANK,X,X,6.6,6.8,BLANK,BLANK,X,X,http://www.cisco.com/en/US/docs/ios/netmgmt/command/reference/nm_09.html#wp1082864,System logging messages are not sent to any remote host.
2.2,2.2.5,Level 1,Set 'logging trap informational',Automated,Limit messages logged to the syslog servers based on severity level informational.,This determines the severity of messages that will generate simple network management protocol (SNMP) trap and or syslog messages. This setting should be set to either "debugging" (7) or "informational" (6), but no lower.,Logging is an important process for an organization managing technology risk. The 'logging trap' command sets the severity of messages and enforces the logging process.,Configure SNMP trap and syslog logging level.
```

hostname(config)#logging trap informational
```,Perform the following to determine if a syslog server for SNMP traps is enabled:

Verify "level informational" returns
```

hostname#sh log | incl trap logging
```,cli,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,Critical,TITLE:Collect Detailed Audit Logs CONTROL:v8 8.5 DESCRIPTION:Configure detailed audit logging for enterprise assets containing sensitive data. Include event source, date, username, timestamp, source addresses, destination addresses, and other useful elements that could assist in a forensic investigation.,TITLE:Enable Detailed Logging CONTROL:v7 6.3 DESCRIPTION:Enable system logging to include detailed information such as an event source, date, user, timestamp, source addresses, destination addresses, and other useful elements.,BLANK,BLANK,8.5,BLANK,BLANK,BLANK,X,X,6.3,BLANK,BLANK,BLANK,X,X,http://www.cisco.com/en/US/docs/ios/netmgmt/command/reference/nm_09.html#wp1015177,Disabled
2.2,2.2.6,Level 1,Set 'service timestamps debug datetime',Automated,Configure the system to apply a time stamp to debugging messages or system logging messages,Including timestamps in log messages allows correlating events and tracing network attacks across multiple devices. Enabling service timestamp to mark the time log messages were generated simplifies obtaining a holistic view of events enabling faster troubleshooting of issues or attacks.,Logging is an important process for an organization managing technology risk and establishing a timeline of events is critical. The 'service timestamps' command sets the date and time on entries sent to the logging host and enforces the logging process.,Configure debug messages to include timestamps.
```

hostname(config)#service timestamps debug datetime {<em>msec</em>} show-timezone
```,Perform the following to determine if the additional detail is enabled:

Verify a command string result returns
```

hostname#sh run | incl service timestamps
```,config file,basic,contain,^service timestamps debug datetime.*,any,none,BLANK,Critical,TITLE:Collect Detailed Audit Logs CONTROL:v8 8.5 DESCRIPTION:Configure detailed audit logging for enterprise assets containing sensitive data. Include event source, date, username, timestamp, source addresses, destination addresses, and other useful elements that could assist in a forensic investigation.,TITLE:Enable Detailed Logging CONTROL:v7 6.3 DESCRIPTION:Enable system logging to include detailed information such as an event source, date, user, timestamp, source addresses, destination addresses, and other useful elements.,BLANK,BLANK,8.5,BLANK,BLANK,BLANK,X,X,6.3,BLANK,BLANK,BLANK,X,X,http://www.cisco.com/en/US/docs/ios-xml/ios/fundamentals/command/R_through_setup.html#GUID-DC110E59-D294-4E3D-B67F-CCB06E607FC6,Time stamps are applied to debug and logging messages.
2.2,2.2.7,Level 1,Set 'logging source interface',Automated,Specify the source IPv4 or IPv6 address of system logging packets,This is required so that the router sends log messages to the logging server from a consistent IP address.,Logging is an important process for an organization managing technology risk and establishing a consistent source of messages for the logging host is critical. The 'logging source interface loopback' command sets a consistent IP address to send messages to the logging host and enforces the logging process.,Bind logging to the loopback interface.
```

hostname(config)#logging source-interface loopback {<em>loopback_interface_number</em>}
```,Perform the following to determine if logging services are bound to a source interface:

Verify a command string result returns
```

hostname#sh run | incl logging source
```,config file,basic,contain,^logging source.*$,any,none,BLANK,Critical,TITLE:Collect Detailed Audit Logs CONTROL:v8 8.5 DESCRIPTION:Configure detailed audit logging for enterprise assets containing sensitive data. Include event source, date, username, timestamp, source addresses, destination addresses, and other useful elements that could assist in a forensic investigation.,TITLE:Enable Detailed Logging CONTROL:v7 6.3 DESCRIPTION:Enable system logging to include detailed information such as an event source, date, user, timestamp, source addresses, destination addresses, and other useful elements.,BLANK,BLANK,8.5,BLANK,BLANK,BLANK,X,X,6.3,BLANK,BLANK,BLANK,X,X,http://www.cisco.com/en/US/docs/ios/netmgmt/command/reference/nm_09.html#wp1095099,The wildcard interface address is used.
2.2,2.2.8,Level 2,Set 'login success/failure logging',Automated,Without generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.,Audit records can be generated from various components within the information system (e.g., module or policy filter).,BLANK,```
hostname(config)#login on-failure log
hostname(config)#login on-success log
hostname(config)#end
```,```
hostname(config)#sho running-config | inc login on-
```,config file,basic,contain,\s*login on-failure log.*,any,none,BLANK,Critical,TITLE:Collect Detailed Audit Logs CONTROL:v8 8.5 DESCRIPTION:Configure detailed audit logging for enterprise assets containing sensitive data. Include event source, date, username, timestamp, source addresses, destination addresses, and other useful elements that could assist in a forensic investigation.,TITLE:Enable Detailed Logging CONTROL:v7 6.3 DESCRIPTION:Enable system logging to include detailed information such as an event source, date, user, timestamp, source addresses, destination addresses, and other useful elements.,BLANK,BLANK,8.5,BLANK,BLANK,BLANK,X,X,6.3,BLANK,BLANK,BLANK,X,X,https://www.cisco.com/c/en/us/td/docs/ios-xml/ios/config-mgmt/configuration/xe-16-6/config-mgmt-xe-16-6-book/cm-config-logger.pdf,BLANK
BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,contain,\s*login on-success log.*,any,and,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK
2.3,BLANK,BLANK,NTP Rules,BLANK,Network Time Protocol allows administrators to set the system time on all of their compatible systems from a single source, ensuring a consistent time stamp for logging and authentication protocols. NTP is an internet standard, defined in RFC1305.,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK
2.3,2.3.2,Level 1,Set 'ip address' for 'ntp server',Automated,Use this command if you want to allow the system to synchronize the system software clock with the specified NTP server.,To ensure that the time on your Cisco router is consistent with other devices in your network, at least two (and preferably at least three) NTP Server/s external to the router should be configured.

Ensure you also configure consistent timezone and daylight savings time setting for all devices. For simplicity, the default of Coordinated Universal Time (UTC).,Organizations should establish multiple Network Time Protocol (NTP) hosts to set consistent time across the enterprise. Enabling the 'ntp server ip address' enforces encrypted authentication between NTP hosts.,Configure at least one external NTP Server using the following commands
```

hostname(config)#ntp server {ntp-server_ip_address}
or 
hostname(config)#ntp server {ntp server vrf [vrf name] ip address}
```,From the command prompt, execute the following commands:
```

hostname#sh ntp associations
```,cli,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,Critical,TITLE:Standardize Time Synchronization CONTROL:v8 8.4 DESCRIPTION:Standardize time synchronization. Configure at least two synchronized time sources across enterprise assets, where supported.,TITLE:Utilize Three Synchronized Time Sources CONTROL:v7 6.1 DESCRIPTION:Use at least three synchronized time sources from which all servers and network devices retrieve time information on a regular basis so that timestamps in logs are consistent.,BLANK,BLANK,8.4,BLANK,BLANK,BLANK,X,X,6.1,BLANK,BLANK,BLANK,X,X,http://www.cisco.com/en/US/docs/ios-xml/ios/bsm/command/bsm-cr-n1.html#GUID-255145EB-D656-43F0-B361-D9CBCC794112:https://www.cisco.com/c/en/us/td/docs/ios-xml/ios/bsm/command/bsm-cr-book/bsm-cr-n1.html#wp3294676008,No servers are configured by default.
2.3.1,BLANK,BLANK,Require Encryption Keys for NTP,BLANK,Encryption keys should be set for NTP Servers.,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK
2.3.1,2.3.1.1,Level 2,Set 'ntp authenticate',Automated,Enable NTP authentication.,Using authenticated NTP ensures the Cisco device only permits time updates from authorized NTP servers.,Organizations should establish three Network Time Protocol (NTP) hosts to set consistent time across the enterprise. Enabling the 'ntp authenticate' command enforces authentication between NTP hosts.,Configure NTP authentication:
```

hostname(config)#ntp authenticate
```,From the command prompt, execute the following commands:
```

hostname#show run | include ntp 
```,config file,basic,contain,ntp,any,none,BLANK,High,TITLE:Standardize Time Synchronization CONTROL:v8 8.4 DESCRIPTION:Standardize time synchronization. Configure at least two synchronized time sources across enterprise assets, where supported.,TITLE:Utilize Three Synchronized Time Sources CONTROL:v7 6.1 DESCRIPTION:Use at least three synchronized time sources from which all servers and network devices retrieve time information on a regular basis so that timestamps in logs are consistent.,BLANK,BLANK,8.4,BLANK,BLANK,BLANK,X,X,6.1,BLANK,BLANK,BLANK,X,X,http://www.cisco.com/en/US/docs/ios-xml/ios/bsm/command/bsm-cr-n1.html#GUID-8BEBDAF4-6D03-4C3E-B8D6-6BCBC7D0F324,NTP authentication is not enabled.
2.3.1,2.3.1.2,Level 2,Set 'ntp authentication-key',Automated,Define an authentication key for Network Time Protocol (NTP).,Using an authentication key provides a higher degree of security as only authenticated NTP servers will be able to update time for the Cisco device.,Organizations should establish three Network Time Protocol (NTP) hosts to set consistent time across the enterprise. Enabling the 'ntp authentication-key' command enforces encrypted authentication between NTP hosts.,Configure at the NTP key ring and encryption key using the following command
```

hostname(config)#ntp authentication-key {ntp_key_id} md5 {ntp_key_hash}
```,From the command prompt, execute the following commands:
```

hostname#show run | include ntp authentication-key
```,config file,basic,contain,ntp authentication-key,any,none,BLANK,High,TITLE:Standardize Time Synchronization CONTROL:v8 8.4 DESCRIPTION:Standardize time synchronization. Configure at least two synchronized time sources across enterprise assets, where supported.,TITLE:Utilize Three Synchronized Time Sources CONTROL:v7 6.1 DESCRIPTION:Use at least three synchronized time sources from which all servers and network devices retrieve time information on a regular basis so that timestamps in logs are consistent.,BLANK,BLANK,8.4,BLANK,BLANK,BLANK,X,X,6.1,BLANK,BLANK,BLANK,X,X,http://www.cisco.com/en/US/docs/ios-xml/ios/bsm/command/bsm-cr-n1.html#GUID-0435BFD1-D7D7-41D4-97AC-7731C11226BC,No authentication key is defined for NTP.
2.3.1,2.3.1.3,Level 2,Set the 'ntp trusted-key',Automated,Ensure you authenticate the identity of a system to which Network Time Protocol (NTP) will synchronize,This authentication function provides protection against accidentally synchronizing the system to another system that is not trusted, because the other system must know the correct authentication key.,Organizations should establish three Network Time Protocol (NTP) hosts to set consistent time across the enterprise. Enabling the 'ntp trusted-key' command enforces encrypted authentication between NTP hosts.,Configure the NTP trusted key using the following command
```

hostname(config)#ntp trusted-key {ntp_key_id}
```,From the command prompt, execute the following commands:
```

hostname#show run | include ntp trusted-key 
```
The above command should return any NTP server(s) configured with encryption keys. This value should be the same as the total number of servers configured as tested in.,config file,basic,contain,ntp trusted-key,any,none,BLANK,High,TITLE:Standardize Time Synchronization CONTROL:v8 8.4 DESCRIPTION:Standardize time synchronization. Configure at least two synchronized time sources across enterprise assets, where supported.,TITLE:Utilize Three Synchronized Time Sources CONTROL:v7 6.1 DESCRIPTION:Use at least three synchronized time sources from which all servers and network devices retrieve time information on a regular basis so that timestamps in logs are consistent.,BLANK,BLANK,8.4,BLANK,BLANK,BLANK,X,X,6.1,BLANK,BLANK,BLANK,X,X,http://www.cisco.com/en/US/docs/ios-xml/ios/bsm/command/bsm-cr-n1.html#GUID-89CA798D-0F12-4AE8-B382-DE10CBD261DB,Authentication of the identity of the system is disabled.
2.3.1,2.3.1.4,Level 2,Set 'key' for each 'ntp server',Automated,Specifies the authentication key for NTP.,This authentication feature provides protection against accidentally synchronizing the ntp system to another system that is not trusted, because the other system must know the correct authentication key.,Organizations should establish three Network Time Protocol (NTP) hosts to set consistent time across the enterprise. Enabling the 'ntp server key' command enforces encrypted authentication between NTP hosts.,Configure each NTP Server to use a key ring using the following command.
```

hostname(config)#ntp server {<em>ntp-server_ip_address</em>}{key <em>ntp_key_id</em>} 
```,From the command prompt, execute the following commands:
```

hostname#show run | include ntp server
```,config file,basic,contain,ntp server,any,none,BLANK,High,TITLE:Standardize Time Synchronization CONTROL:v8 8.4 DESCRIPTION:Standardize time synchronization. Configure at least two synchronized time sources across enterprise assets, where supported.,TITLE:Utilize Three Synchronized Time Sources CONTROL:v7 6.1 DESCRIPTION:Use at least three synchronized time sources from which all servers and network devices retrieve time information on a regular basis so that timestamps in logs are consistent.,BLANK,BLANK,8.4,BLANK,BLANK,BLANK,X,X,6.1,BLANK,BLANK,BLANK,X,X,BLANK,No NTP key is set by default
2.4,BLANK,BLANK,Loopback Rules,BLANK,When a router needs to initiate connections to remote hosts, for example for SYSLOG or NTP, it will use the nearest interface for the packets source address. This can cause issues due to the possible variation in source, potentially causing packets to be denied by intervening firewalls or handled incorrectly by the receiving host. To prevent these problems the router should be configured with a Loopback interface and any services should be bound to this address.,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK
2.4,2.4.1,Level 2,Create a single 'interface loopback',Automated,Configure a single loopback interface.,Software-only loopback interface that emulates an interface that is always up. It is a virtual interface supported on all platforms.

Alternate loopback addresses create a potential for abuse, mis-configuration, and inconsistencies. Additional loopback interfaces must be documented and approved prior to use by local security personnel.,Organizations should plan and establish 'loopback interfaces' for the enterprise network. Loopback interfaces enable critical network information such as OSPF Router IDs and provide termination points for routing protocol sessions.,Define and configure one loopback interface.
```

hostname(config)#interface loopback <<em>number</em>>
hostname(config-if)#ip address <<em>loopback_ip_address</em>> <<em>loopback_subnet_mask</em>> 
```,Perform the following to determine if a loopback interface is defined:

Verify an IP address returns for the defined loopback interface
```

hostname#sh ip int brief | incl Loopback
```,cli,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,High,TITLE:Explicitly Not Mapped CONTROL:v8 0.0 DESCRIPTION:Explicitly Not Mapped,TITLE:Ensure Only Approved Ports, Protocols and Services Are Running CONTROL:v7 9.2 DESCRIPTION:Ensure that only network ports, protocols, and services listening on a system with validated business needs, are running on each system.,BLANK,BLANK,0.0,BLANK,BLANK,BLANK,BLANK,BLANK,9.2,BLANK,BLANK,BLANK,X,X,http://www.cisco.com/en/US/docs/ios-xml/ios/interface/command/ir-i1.html#GUID-0D6BDFCD-3FBB-4D26-A274-C1221F8592DF,There are no loopback interfaces defined by default.
2.4,2.4.2,Level 2,Set AAA 'source-interface',Automated,Force AAA to use the IP address of a specified interface for all outgoing AAA packets,This is required so that the AAA server (RADIUS or TACACS+) can easily identify routers and authenticate requests by their IP address.,Organizations should design and implement authentication, authorization, and accounting (AAA) services for effective monitoring of enterprise network devices. Binding AAA services to the source-interface loopback enables these services.,Bind AAA services to the loopback interface.
```

Hostname(config)#ip radius source-interface loopback {loopback_interface_number}
or
Hostname(config)#aaa group server tacacs+ {group_name} hostname(config-sg-tacacs+)#ip tacacs source-interface {loopback_interface_number}
```,Perform the following to determine if AAA services are bound to a source interface:

Verify a command string result returns
```

hostname#sh run | incl tacacs source | radius source
```,config file,basic,contain,.*(radius|tacacs) source-interface.*,any,none,BLANK,High,TITLE:Centralize Account Management CONTROL:v8 5.6 DESCRIPTION:Centralize account management through a directory or identity service.,TITLE:Configure Centralized Point of Authentication CONTROL:v7 16.2 DESCRIPTION:Configure access for all accounts through as few centralized points of authentication as possible, including network, security, and cloud systems.,BLANK,BLANK,5.6,BLANK,BLANK,BLANK,X,X,16.2,BLANK,BLANK,BLANK,X,X,http://www.cisco.com/en/US/docs/ios-xml/ios/security/d1/sec-cr-i2.html#GUID-22E8B211-751F-48E0-9C76-58F0FE0AABA8:http://www.cisco.com/en/US/docs/ios-xml/ios/security/d1/sec-cr-i3.html#GUID-54A00318-CF69-46FC-9ADC-313BFC436713,BLANK
2.4,2.4.3,Level 2,Set 'ntp source' to Loopback Interface,Automated,Use a particular source address in Network Time Protocol (NTP) packets.,Set the source address to be used when sending NTP traffic. This may be required if the NTP servers you peer with filter based on IP address.,Organizations should plan and implement network time protocol (NTP) services to establish official time for all enterprise network devices. Setting 'ntp source loopback' enforces the proper IP address for NTP services.,Bind the NTP service to the loopback interface.
```

hostname(config)#ntp source loopback {<em>loopback_interface_number}</em>
```,Perform the following to determine if NTP services are bound to a source interface:

Verify a command string result returns
```

hostname#sh run | incl ntp source
```,config file,basic,contain,\s*ntp source.*,any,none,BLANK,High,TITLE:Standardize Time Synchronization CONTROL:v8 8.4 DESCRIPTION:Standardize time synchronization. Configure at least two synchronized time sources across enterprise assets, where supported.,TITLE:Utilize Three Synchronized Time Sources CONTROL:v7 6.1 DESCRIPTION:Use at least three synchronized time sources from which all servers and network devices retrieve time information on a regular basis so that timestamps in logs are consistent.,BLANK,BLANK,8.4,BLANK,BLANK,BLANK,X,X,6.1,BLANK,BLANK,BLANK,X,X,http://www.cisco.com/en/US/docs/ios-xml/ios/bsm/command/bsm-cr-n1.html#GUID-DF29FBFB-E1C0-4E5C-9013-D4CE59CA0B88,Source address is determined by the outgoing interface.
2.4,2.4.4,Level 2,Set 'ip tftp source-interface' to the Loopback Interface,Automated,Specify the IP address of an interface as the source address for TFTP connections.,This is required so that the TFTP servers can easily identify routers and authenticate requests by their IP address.,Organizations should plan and implement trivial file transfer protocol (TFTP) services in the enterprise by setting 'tftp source-interface loopback', which enables the TFTP servers to identify routers and authenticate requests by IP address.,Bind the TFTP client to the loopback interface.
```

hostname(config)#ip tftp source-interface loopback {<em>loobpback_interface_number</em>}
```,Perform the following to determine if TFTP services are bound to a source interface:

Verify a command string result returns
```

hostname#sh run | incl tftp source-interface
```,config file,basic,contain,\s*tftp source-interface.*,any,none,BLANK,High,TITLE:Explicitly Not Mapped CONTROL:v8 0.0 DESCRIPTION:Explicitly Not Mapped,TITLE:Ensure Only Approved Ports, Protocols and Services Are Running CONTROL:v7 9.2 DESCRIPTION:Ensure that only network ports, protocols, and services listening on a system with validated business needs, are running on each system.,BLANK,BLANK,0.0,BLANK,BLANK,BLANK,BLANK,BLANK,9.2,BLANK,BLANK,BLANK,X,X,http://www.cisco.com/en/US/docs/ios-xml/ios/fundamentals/command/F_through_K.html#GUID-9AA27050-A578-47CD-9F1D-5A8E2B449209,The address of the closest interface to the destination is selected as the source address.
3,BLANK,BLANK,Data Plane,BLANK,Services and settings related to the data passing through the router (as opposed to direct to it). The data plane is for everything not in control or management planes. Settings on a router concerned with the data plane include interface access lists, firewall functionality (e.g. CBAC), NAT, and IPSec. Settings for traffic-affecting services like unicast RPF verification and CAR/QoS also fall into this area.,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK
3.1,BLANK,BLANK,Routing Rules,BLANK,Unneeded services should be disabled.,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK
3.1,3.1.1,Level 1,Set 'no ip source-route',Automated,Disable the handling of IP datagrams with source routing header options.,Source routing is a feature of IP whereby individual packets can specify routes. This feature is used in several kinds of attacks. Cisco routers normally accept and process source routes. Unless a network depends on source routing, it should be disabled.,Organizations should plan and implement network policies to ensure unnecessary services are explicitly disabled. The 'ip source-route' feature has been used in several attacks and should be disabled.,Disable source routing.
```

hostname(config)#no ip source-route
```,Verify the command string result returns
```

hostname#sh run | incl ip source-route
```,config file,basic,contain,\s*no ip source-route.*,any,none,BLANK,High,TITLE:Explicitly Not Mapped CONTROL:v8 0.0 DESCRIPTION:Explicitly Not Mapped,TITLE:Ensure Only Approved Ports, Protocols and Services Are Running CONTROL:v7 9.2 DESCRIPTION:Ensure that only network ports, protocols, and services listening on a system with validated business needs, are running on each system.,BLANK,BLANK,0.0,BLANK,BLANK,BLANK,BLANK,BLANK,9.2,BLANK,BLANK,BLANK,X,X,http://www.cisco.com/en/US/docs/ios-xml/ios/ipaddr/command/ipaddr-i4.html#GUID-C7F971DD-358F-4B43-9F3E-244F5D4A3A93,Enabled by default
3.1,3.1.2,Level 2,Set 'no ip proxy-arp',Automated,Disable proxy ARP on all interfaces.,Address Resolution Protocol (ARP) provides resolution between IP and MAC Addresses (or other Network and Link Layer addresses on none IP networks) within a Layer 2 network.

Proxy ARP is a service where a device connected to one network (in this case the Cisco router) answers ARP Requests which are addressed to a host on another network, replying with its own MAC Address and forwarding the traffic on to the intended host.

Sometimes used for extending broadcast domains across WAN links, in most cases Proxy ARP on enterprise networks is used to enable communication for hosts with mis-configured subnet masks, a situation which should no longer be a common problem. Proxy ARP effectively breaks the LAN Security Perimeter, extending a network across multiple Layer 2 segments. Using Proxy ARP can also allow other security controls such as PVLAN to be bypassed.,Organizations should plan and implement network policies to ensure unnecessary services are explicitly disabled. The 'ip proxy-arp' feature effectively breaks the LAN security perimeter and should be disabled.,Disable proxy ARP on all interfaces.
```

hostname(config)#interface {interface}
hostname(config-if)#no ip proxy-arp

```,Verify the proxy ARP status
```

hostname#sh ip int {<em>interface</em>} | incl proxy-arp 
```,cli,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,High,TITLE:Explicitly Not Mapped CONTROL:v8 0.0 DESCRIPTION:Explicitly Not Mapped,TITLE:Ensure Only Approved Ports, Protocols and Services Are Running CONTROL:v7 9.2 DESCRIPTION:Ensure that only network ports, protocols, and services listening on a system with validated business needs, are running on each system.,BLANK,BLANK,0.0,BLANK,BLANK,BLANK,BLANK,BLANK,9.2,BLANK,BLANK,BLANK,X,X,http://www.cisco.com/en/US/docs/ios-xml/ios/ipaddr/command/ipaddr-i4.html#GUID-AEB7DDCB-7B3D-4036-ACF0-0A0250F3002E,Enabled
3.1,3.1.3,Level 1,Set 'no interface tunnel',Automated,Verify no tunnel interfaces are defined.,Tunnel interfaces should not exist in general. They can be used for malicious purposes. If they are necessary, the network admin's should be well aware of them and their purpose.,Organizations should plan and implement enterprise network security policies that disable insecure and unnecessary features that increase attack surfaces such as 'tunnel interfaces'.,Remove any tunnel interfaces.
```

hostname(config)#no interface tunnel {<em>instance</em>}
```,Verify no tunnel interfaces are defined
```

hostname#sh ip int brief | incl tunnel 
```,cli,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,High,TITLE:Explicitly Not Mapped CONTROL:v8 0.0 DESCRIPTION:Explicitly Not Mapped,TITLE:Ensure Only Approved Ports, Protocols and Services Are Running CONTROL:v7 9.2 DESCRIPTION:Ensure that only network ports, protocols, and services listening on a system with validated business needs, are running on each system.,BLANK,BLANK,0.0,BLANK,BLANK,BLANK,BLANK,BLANK,9.2,BLANK,BLANK,BLANK,X,X,http://www.cisco.com/en/US/docs/ios-xml/ios/interface/command/ir-i1.html#GUID-0D6BDFCD-3FBB-4D26-A274-C1221F8592DF,No tunnel interfaces are defined
3.1,3.1.4,Level 1,Set 'ip verify unicast source reachable-via',Automated,Examines incoming packets to determine whether the source address is in the Forwarding Information Base (FIB) and permits the packet only if the source is reachable through the interface on which the packet was received (sometimes referred to as strict mode).,Enabled uRPF helps mitigate IP spoofing by ensuring only packet source IP addresses only originate from expected interfaces. Configure unicast reverse-path forwarding (uRPF) on all external or high risk interfaces.,Organizations should plan and implement enterprise security policies that protect the confidentiality, integrity, and availability of network devices. The 'unicast Reverse-Path Forwarding' (uRPF) feature dynamically uses the router table to either accept or drop packets when arriving on an interface.,Configure uRPF.
```

hostname(config)#interface {<em>interface_name</em>}
hostname(config-if)#ip verify unicast source reachable-via rx allow-default
```,Verify uRPF is running on the appropriate interface(s)
```

hostname#sh ip int {<em>interface</em>} | incl verify source 
```,cli,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,High,TITLE:Explicitly Not Mapped CONTROL:v8 0.0 DESCRIPTION:Explicitly Not Mapped,TITLE:Ensure Only Approved Ports, Protocols and Services Are Running CONTROL:v7 9.2 DESCRIPTION:Ensure that only network ports, protocols, and services listening on a system with validated business needs, are running on each system.,BLANK,BLANK,0.0,BLANK,BLANK,BLANK,BLANK,BLANK,9.2,BLANK,BLANK,BLANK,X,X,http://www.cisco.com/en/US/docs/ios-xml/ios/security/d1/sec-cr-i3.html#GUID-2ED313DB-3D3F-49D7-880A-047463632757:https://community.cisco.com/t5/routing/ip-verify-unicast-source-reachable-via-rx/td-p/1710172,Unicast RPF is disabled.
3.2,BLANK,BLANK,Border Router Filtering,BLANK,A border-filtering device connects "internal" networks such as desktop networks, DMZ networks, etc., to "external" networks such as the Internet. If this group is chosen, then ingress and egress filter rules will be required.,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK
3.2,3.2.1,Level 2,Set 'ip access-list extended' to Forbid Private Source Addresses from External Networks,Automated,This command places the router in access-list configuration mode, where you must define the denied or permitted access conditions by using the deny and permit commands.,Configuring access controls can help prevent spoofing attacks. To reduce the effectiveness of IP spoofing, configure access control to deny any traffic from the external network that has a source address that should reside on the internal network. Include local host address or any reserved private addresses (RFC 1918).

Ensure the `permit `rule(s) above the final `deny `rule only allow traffic according to your organization's least privilege policy.,Organizations should plan and implement enterprise security policies that explicitly separate internal from external networks. Adding 'ip access-list' explicitly permitting and denying internal and external networks enforces these policies.,Configure ACL for private source address restrictions from external networks.
```

hostname(config)#ip access-list extended {<span><em>name | number</em>} 
</span><span>hostname(config-nacl)#deny ip {</span><em>internal_networks</em>} any log
hostname(config<span>-nacl</span>)#deny ip 127.0.0.0 0.255.255.255 any log
hostname(config<span>-nacl</span>)#deny ip 10.0.0.0 0.255.255.255 any log
hostname(config<span>-nacl</span>)#deny ip 0.0.0.0 0.255.255.255 any log
hostname(config<span>-nacl</span>)#deny ip 172.16.0.0 0.15.255.255 any log
hostname(config<span>-nacl</span>)#deny ip 192.168.0.0 0.0.255.255 any log
hostname(config<span>-nacl</span>)#deny ip 192.0.2.0 0.0.0.255 any log
hostname(config<span>-nacl</span>)#deny ip 169.254.0.0 0.0.255.255 any log
hostname(config<span>-nacl</span>)#deny ip 224.0.0.0 31.255.255.255 any log
hostname(config<span>-nacl</span>)#deny ip host 255.255.255.255 any log
hostname(config<span>-nacl</span>)#permit {protocol} {source_ip} {source_mask} {destination} {destination_mask} log
hostname(config<span>-nacl</span>)#deny any any log
hostname(config)#interface <external_<em>interface</em>>
hostname(config-if)#access-group <<em>access-list</em>> in

```,Verify you have the appropriate access-list definitions
```

hostname#sh ip access-list {<em>name | number</em>}
```,cli,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,Medium,TITLE:Explicitly Not Mapped CONTROL:v8 0.0 DESCRIPTION:Explicitly Not Mapped,TITLE:Ensure Only Approved Ports, Protocols and Services Are Running CONTROL:v7 9.2 DESCRIPTION:Ensure that only network ports, protocols, and services listening on a system with validated business needs, are running on each system.,BLANK,BLANK,0.0,BLANK,BLANK,BLANK,BLANK,BLANK,9.2,BLANK,BLANK,BLANK,X,X,http://www.cisco.com/en/US/docs/ios-xml/ios/security/d1/sec-cr-i1.html#GUID-BD76E065-8EAC-4B32-AF25-04BA94DD2B11,No access list defined
3.2,3.2.2,Level 2,Set inbound 'ip access-group' on the External Interface,Automated,This command places the router in access-list configuration mode, where you must define the denied or permitted access conditions by using the deny and permit commands.,Configuring access controls can help prevent spoofing attacks. To reduce the effectiveness of IP spoofing, configure access control to deny any traffic from the external network that has a source address that should reside on the internal network. Include local host address or any reserved private addresses (RFC 1918).

Ensure the `permit `rule(s) above the final `deny `rule only allow traffic according to your organization's least privilege policy.,Organizations should plan and implement enterprise security policies explicitly permitting and denying access based upon access lists. Using the 'ip access-group' command enforces these policies by explicitly identifying groups permitted access.,Apply the access-group for the external (untrusted) interface
```

hostname(config)#interface {external_interface}
hostname(config-if)#ip access-group {name | number} in
```,Verify the access-group is applied to the appropriate interface
```

hostname#sh run | sec interface {<em>external_interface</em>}
```,config file,advance,BLANK,BLANK,BLANK,BLANK,BLANK,Medium,TITLE:Explicitly Not Mapped CONTROL:v8 0.0 DESCRIPTION:Explicitly Not Mapped,TITLE:Ensure Only Approved Ports, Protocols and Services Are Running CONTROL:v7 9.2 DESCRIPTION:Ensure that only network ports, protocols, and services listening on a system with validated business needs, are running on each system.,BLANK,BLANK,0.0,BLANK,BLANK,BLANK,BLANK,BLANK,9.2,BLANK,BLANK,BLANK,X,X,http://www.cisco.com/en/US/docs/ios-xml/ios/interface/command/ir-i1.html#GUID-0D6BDFCD-3FBB-4D26-A274-C1221F8592DF:http://www.cisco.com/en/US/docs/ios-xml/ios/security/d1/sec-cr-i1.html#GUID-D9FE7E44-7831-4C64-ACB8-840811A0C993,No access-group defined
3.3,BLANK,BLANK,Neighbor Authentication,BLANK,Enable routing authentication.,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK
3.3.1,BLANK,BLANK,Require EIGRP Authentication if Protocol is Used,BLANK,Verify enhanced interior gateway routing protocol (EIGRP) authentication is enabled, if routing protocol is used, where feasible.,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK
3.3.1,3.3.1.1,Level 2,Set 'key chain',Automated,Define an authentication key chain to enable authentication for routing protocols. A key chain must have at least one key and can have up to 2,147,483,647 keys.

NOTE: Only DRP Agent, EIGRP, and RIPv2 use key chains.,Routing protocols such as DRP Agent, EIGRP, and RIPv2 use key chains for authentication.,Organizations should plan and implement enterprise security policies that require rigorous authentication methods for routing protocols. Using 'key chains' for routing protocols enforces these policies.,Establish the key chain.
```

hostname(config)#key chain {<em>key-chain_name</em>}
```,Verify the appropriate key chain is defined
```

hostname#sh run | sec key chain 
```,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,Medium,TITLE:Establish and Maintain a Secure Configuration Process for Network Infrastructure CONTROL:v8 4.2 DESCRIPTION:Establish and maintain a secure configuration process for network devices. Review and update documentation annually, or when significant enterprise changes occur that could impact this Safeguard.,TITLE:Ensure Only Approved Ports, Protocols and Services Are Running CONTROL:v7 9.2 DESCRIPTION:Ensure that only network ports, protocols, and services listening on a system with validated business needs, are running on each system.,BLANK,BLANK,4.2,BLANK,BLANK,X,X,X,9.2,BLANK,BLANK,BLANK,X,X,http://www.cisco.com/en/US/docs/ios-xml/ios/iproute_pi/command/iri-cr-a1.html#GUID-A62E89F5-0B8B-4CF0-B4EB-08F2762D88BB,Not set
3.3.1,3.3.1.2,Level 2,Set 'key',Automated,Configure an authentication key on a key chain.,This is part of the routing authentication setup,Organizations should plan and implement enterprise security policies that require rigorous authentication methods for routing protocols. Using 'key numbers' for key chains for routing protocols enforces these policies.,Configure the key number.
```

hostname(config-keychain)#key {<em>key-number</em>}
```,Verify the appropriate key chain is defined
```

hostname#sh run | sec key chain 
```,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,Medium,TITLE:Establish and Maintain a Secure Configuration Process for Network Infrastructure CONTROL:v8 4.2 DESCRIPTION:Establish and maintain a secure configuration process for network devices. Review and update documentation annually, or when significant enterprise changes occur that could impact this Safeguard.,TITLE:Ensure Only Approved Ports, Protocols and Services Are Running CONTROL:v7 9.2 DESCRIPTION:Ensure that only network ports, protocols, and services listening on a system with validated business needs, are running on each system.,BLANK,BLANK,4.2,BLANK,BLANK,X,X,X,9.2,BLANK,BLANK,BLANK,X,X,http://www.cisco.com/en/US/docs/ios-xml/ios/iproute_pi/command/iri-cr-a1.html#GUID-3F31B2E0-0E4B-4F49-A4A8-8ADA1CA0D73F,BLANK
3.3.1,3.3.1.3,Level 2,Set 'key-string',Automated,Configure the authentication string for a key.,This is part of the routing authentication setup,Organizations should plan and implement enterprise security policies that require rigorous authentication methods for routing protocols. Using 'key strings' for key chains for routing protocols enforces these policies.,Configure the key string.
```

hostname(config-keychain-key)#key-string <<em>key-string</em>> 
```,Verify the appropriate key chain is defined
```

hostname#sh run | sec key chain 
```,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,Medium,TITLE:Establish and Maintain a Secure Configuration Process for Network Infrastructure CONTROL:v8 4.2 DESCRIPTION:Establish and maintain a secure configuration process for network devices. Review and update documentation annually, or when significant enterprise changes occur that could impact this Safeguard.,TITLE:Ensure Only Approved Ports, Protocols and Services Are Running CONTROL:v7 9.2 DESCRIPTION:Ensure that only network ports, protocols, and services listening on a system with validated business needs, are running on each system.,BLANK,BLANK,4.2,BLANK,BLANK,X,X,X,9.2,BLANK,BLANK,BLANK,X,X,http://www.cisco.com/en/US/docs/ios-xml/ios/iproute_pi/command/iri-cr-a1.html#GUID-D7A8DC18-2E16-4EA5-8762-8B68B94CC43E,Not set
3.3.1,3.3.1.4,Level 2,Set 'address-family ipv4 autonomous-system',Automated,Configure the EIGRP address family.,Rationale: EIGRP is a true multi-protocol routing protocol and the 'address-family' feature enables restriction of exchanges with specific neighbors,Organizations should plan and implement enterprise security policies that require rigorous authentication methods for routing protocols. Using 'address-family' for EIGRP enforces these policies by restricting the exchanges between predefined network devices.,Configure the EIGRP address family.
```

hostname(config)#router eigrp <<em>virtual-instance-name</em>>
hostname(config-router)#address-family ipv4 autonomous-system {<em>eigrp_as-number</em>}
```,Verify the appropriate address family is set
```

hostname#sh run | sec router eigrp 
```,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,Medium,TITLE:Establish and Maintain a Secure Configuration Process for Network Infrastructure CONTROL:v8 4.2 DESCRIPTION:Establish and maintain a secure configuration process for network devices. Review and update documentation annually, or when significant enterprise changes occur that could impact this Safeguard.,TITLE:Ensure Only Approved Ports, Protocols and Services Are Running CONTROL:v7 9.2 DESCRIPTION:Ensure that only network ports, protocols, and services listening on a system with validated business needs, are running on each system.,BLANK,BLANK,4.2,BLANK,BLANK,X,X,X,9.2,BLANK,BLANK,BLANK,X,X,http://www.cisco.com/en/US/docs/ios-xml/ios/iproute_eigrp/command/ire-i1.html#GUID-67388D6C-AE9C-47CA-8C35-2A2CF9FA668E:http://www.cisco.com/en/US/docs/ios-xml/ios/iproute_eigrp/command/ire-a1.html#GUID-C03CFC8A-3CE3-4CF9-9D65-52990DBD3377,Not set
3.3.1,3.3.1.5,Level 2,Set 'af-interface default',Automated,Defines user defaults to apply to EIGRP interfaces that belong to an address-family.,Part of the EIGRP address-family setup,Organizations should plan and implement enterprise security policies that require rigorous authentication methods for routing protocols. Using 'af-interface default' for EIGRP interfaces enforces these policies by restricting the exchanges between predefined network devices.,Configure the EIGRP address family.
```

hostname(config)#router eigrp <<em>virtual-instance-name</em>>
hostname(config-router)#address-family ipv4 autonomous-system {<em>eigrp_as-number</em>}
hostname(config-router-af)#af-interface default 
```,Verify the setting
```

hostname#sh run | sec router eigrp 
```,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,Medium,TITLE:Establish and Maintain a Secure Configuration Process for Network Infrastructure CONTROL:v8 4.2 DESCRIPTION:Establish and maintain a secure configuration process for network devices. Review and update documentation annually, or when significant enterprise changes occur that could impact this Safeguard.,TITLE:Ensure Only Approved Ports, Protocols and Services Are Running CONTROL:v7 9.2 DESCRIPTION:Ensure that only network ports, protocols, and services listening on a system with validated business needs, are running on each system.,BLANK,BLANK,4.2,BLANK,BLANK,X,X,X,9.2,BLANK,BLANK,BLANK,X,X,http://www.cisco.com/en/US/docs/ios-xml/ios/iproute_eigrp/command/ire-i1.html#GUID-67388D6C-AE9C-47CA-8C35-2A2CF9FA668E:http://www.cisco.com/en/US/docs/ios-xml/ios/iproute_eigrp/command/ire-a1.html#GUID-C03CFC8A-3CE3-4CF9-9D65-52990DBD3377:http://www.cisco.com/en/US/docs/ios-xml/ios/iproute_eigrp/command/ire-a1.html#GUID-DC0EF1D3-DFD4-45DF-A553-FA432A3E7233,Not set
3.3.1,3.3.1.6,Level 2,Set 'authentication key-chain',Automated,Configure the EIGRP address family key chain.,This is part of the EIGRP authentication configuration,Organizations should plan and implement enterprise security policies that require rigorous authentication methods for routing protocols. Using the address-family 'key chain' for EIGRP enforces these policies by restricting the exchanges between predefined network devices.,Configure the EIGRP address family key chain.
```

hostname(config)#router eigrp <virtual-instance-name>
hostname(config-router)#address-family ipv4 autonomous-system {eigrp_as-number}
hostname(config-router-af)#af-interface {interface-name}
hostname(config-router-af-interface)#authentication key-chain {eigrp_key-chain_name}
```,Verify the appropriate key chain is set
```

hostname#sh run | sec router eigrp 
```,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,Medium,TITLE:Establish and Maintain a Secure Configuration Process for Network Infrastructure CONTROL:v8 4.2 DESCRIPTION:Establish and maintain a secure configuration process for network devices. Review and update documentation annually, or when significant enterprise changes occur that could impact this Safeguard.,TITLE:Ensure Only Approved Ports, Protocols and Services Are Running CONTROL:v7 9.2 DESCRIPTION:Ensure that only network ports, protocols, and services listening on a system with validated business needs, are running on each system.,BLANK,BLANK,4.2,BLANK,BLANK,X,X,X,9.2,BLANK,BLANK,BLANK,X,X,http://www.cisco.com/en/US/docs/ios-xml/ios/iproute_eigrp/command/ire-i1.html#GUID-67388D6C-AE9C-47CA-8C35-2A2CF9FA668E:http://www.cisco.com/en/US/docs/ios-xml/ios/iproute_eigrp/command/ire-a1.html#GUID-C03CFC8A-3CE3-4CF9-9D65-52990DBD3377:http://www.cisco.com/en/US/docs/ios-xml/ios/iproute_eigrp/command/ire-a1.html#GUID-6B6ED6A3-1AAA-4EFA-B6B8-9BF11EEC37A0,No key chains are specified for EIGRP
3.3.1,3.3.1.7,Level 1,Set 'authentication mode md5',Automated,Configure authentication to prevent unapproved sources from introducing unauthorized or false service messages.,This is part of the EIGRP authentication configuration,Organizations should plan and implement enterprise security policies that require rigorous authentication methods for routing protocols. Using the 'authentication mode' for EIGRP address-family or service-family packets enforces these policies by restricting the type of authentication between network devices.,Configure the EIGRP address family authentication mode.
```

hostname(config)#router eigrp <virtual-instance-name>
hostname(config-router)#address-family ipv4 autonomous-system {eigrp_as-number}
hostname(config-router-af)#af-interface {interface-name}
hostname(config-router-af-interface)#authentication mode md5
```,Verify the appropriate address family authentication mode is set
```

hostname#sh run | sec router eigrp 
```,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,Medium,TITLE:Establish and Maintain a Secure Configuration Process for Network Infrastructure CONTROL:v8 4.2 DESCRIPTION:Establish and maintain a secure configuration process for network devices. Review and update documentation annually, or when significant enterprise changes occur that could impact this Safeguard.,TITLE:Ensure Only Approved Ports, Protocols and Services Are Running CONTROL:v7 9.2 DESCRIPTION:Ensure that only network ports, protocols, and services listening on a system with validated business needs, are running on each system.,BLANK,BLANK,4.2,BLANK,BLANK,X,X,X,9.2,BLANK,BLANK,BLANK,X,X,http://www.cisco.com/en/US/docs/ios-xml/ios/iproute_eigrp/command/ire-i1.html#GUID-67388D6C-AE9C-47CA-8C35-2A2CF9FA668E:http://www.cisco.com/en/US/docs/ios-xml/ios/iproute_eigrp/command/ire-a1.html#GUID-C03CFC8A-3CE3-4CF9-9D65-52990DBD3377:http://www.cisco.com/en/US/docs/ios-xml/ios/iproute_eigrp/command/ire-a1.html#GUID-A29E0EF6-4CEF-40A7-9824-367939001B73,Not defined
3.3.1,3.3.1.8,Level 2,Set 'ip authentication key-chain eigrp',Automated,Specify the type of authentication used in Enhanced Interior Gateway Routing Protocol (EIGRP) packets per interface.,Configuring EIGRP authentication key-chain number and name to restrict packet exchanges between network devices.,Organizations should plan and implement enterprise security policies that require rigorous authentication methods for routing protocols. Configuring the interface with 'ip authentication key chain' for EIGRP by name and number enforces these policies by restricting the exchanges between network devices.,Configure the interface with the EIGRP key chain.
```

hostname(config)#interface {<em>interface_name</em>}
hostname(config-if)#ip authentication key-chain eigrp {<em>eigrp_as-number</em>} {<em>eigrp_key-chain_name</em>}
```,Verify the appropriate key chain is set on the appropriate interface(s)
```
hostname#sh ip eigrp int
hostname#sh run int {<em>interface_name</em>} | incl key-chain 
```,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,Medium,TITLE:Establish and Maintain a Secure Configuration Process for Network Infrastructure CONTROL:v8 4.2 DESCRIPTION:Establish and maintain a secure configuration process for network devices. Review and update documentation annually, or when significant enterprise changes occur that could impact this Safeguard.,TITLE:Ensure Only Approved Ports, Protocols and Services Are Running CONTROL:v7 9.2 DESCRIPTION:Ensure that only network ports, protocols, and services listening on a system with validated business needs, are running on each system.,BLANK,BLANK,4.2,BLANK,BLANK,X,X,X,9.2,BLANK,BLANK,BLANK,X,X,http://www.cisco.com/en/US/docs/ios-xml/ios/interface/command/ir-i1.html#GUID-0D6BDFCD-3FBB-4D26-A274-C1221F8592DF:http://www.cisco.com/en/US/docs/ios-xml/ios/iproute_eigrp/command/ire-i1.html#GUID-0B344B46-5E8E-4FE2-A3E0-D92410CE5E91,Not set
3.3.1,3.3.1.9,Level 2,Set 'ip authentication mode eigrp',Automated,Configure authentication to prevent unapproved sources from introducing unauthorized or false routing messages.,This is part of the EIGRP authentication configuration,Organizations should plan and implement enterprise security policies that require rigorous authentication methods for routing protocols. Configuring the interface with 'ip authentication mode' for EIGRP by number and mode enforces these policies by restricting the exchanges between network devices.,Configure the interface with the EIGRP authentication mode.
```

hostname(config)#interface {<em>interface_name</em>}
hostname(config-if)#ip authentication mode eigrp {<em><span>eigrp_as-number</span></em><span>}</span> md5
```,Verify the appropriate authentication mode is set on the appropriate interface(s)
```
hostname#sh ip eigrp int
hostname#sh run int {<em>interface_name</em>} | incl authentication mode
```,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,Medium,TITLE:Establish and Maintain a Secure Configuration Process for Network Infrastructure CONTROL:v8 4.2 DESCRIPTION:Establish and maintain a secure configuration process for network devices. Review and update documentation annually, or when significant enterprise changes occur that could impact this Safeguard.,TITLE:Ensure Only Approved Ports, Protocols and Services Are Running CONTROL:v7 9.2 DESCRIPTION:Ensure that only network ports, protocols, and services listening on a system with validated business needs, are running on each system.,BLANK,BLANK,4.2,BLANK,BLANK,X,X,X,9.2,BLANK,BLANK,BLANK,X,X,http://www.cisco.com/en/US/docs/ios-xml/ios/interface/command/ir-i1.html#GUID-0D6BDFCD-3FBB-4D26-A274-C1221F8592DF:http://www.cisco.com/en/US/docs/ios-xml/ios/iproute_eigrp/command/ire-i1.html#GUID-8D1B0697-8E96-4D8A-BD20-536956D68506,Not set
3.3.2,BLANK,BLANK,Require OSPF Authentication if Protocol is Used,BLANK,Verify open shortest path first (OSPF) authentication is enabled, where feasible.,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK
3.3.2,3.3.2.1,Level 2,Set 'authentication message-digest' for OSPF area,Automated,Enable MD5 authentication for OSPF.,This is part of the OSPF authentication setup.,Organizations should plan and implement enterprise security policies that require rigorous authentication methods for routing protocols. Configuring the area 'authentication message-digest' for OSPF enforces these policies by restricting exchanges between network devices.,Configure the Message Digest option for OSPF.
```

hostname(config)#router ospf <<em>ospf_process-id</em>>
hostname(config-router)#area <<em>ospf_area-id</em>> authentication message-digest 
```,Verify message digest for OSPF is defined
```
hostname#sh run | sec router ospf 
```,config file,basic,contain,area\s+\d+\s+authentication\s+message-digest,any,none,The authentication type must be the same for all routers and access servers in an area. The authentication password for all OSPF routers on a network must be the same if they are to communicate with each other via OSPF,Medium,TITLE:Explicitly Not Mapped CONTROL:v8 0.0 DESCRIPTION:Explicitly Not Mapped,TITLE:Explicitly Not Mapped CONTROL:v7 0.0 DESCRIPTION:Explicitly Not Mapped,BLANK,BLANK,0.0,BLANK,BLANK,BLANK,BLANK,BLANK,0.0,BLANK,BLANK,BLANK,BLANK,BLANK,http://www.cisco.com/en/US/docs/ios-xml/ios/iproute_ospf/command/ospf-i1.html#GUID-3D5781A3-F8DF-4760-A551-6A3AB80A42ED:http://www.cisco.com/en/US/docs/ios-xml/ios/iproute_ospf/command/ospf-a1.html#GUID-81D0F753-D8D5-494E-9A10-B15433CFD445,Not set
3.3.2,3.3.2.2,Level 2,Set 'ip ospf message-digest-key md5',Automated,Enable Open Shortest Path First (OSPF) Message Digest 5 (MD5) authentication.,This is part of the OSPF authentication setup,Organizations should plan and implement enterprise security policies that require rigorous authentication methods for routing protocols. Configuring the proper interface(s) for 'ip ospf message-digest-key md5' enforces these policies by restricting exchanges between network devices.,Configure the appropriate interface(s) for Message Digest authentication
```

hostname(config)#interface {<em>interface_name</em>}
hostname(config-if)#ip ospf message-digest-key {<em>ospf_md5_key-id</em>} md5 {<em>ospf_md5_key</em>}
```,Verify the appropriate md5 key is defined on the appropriate interface(s)
```

hostname#sh run int {<em>interface</em>}
```,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,Medium,TITLE:Explicitly Not Mapped CONTROL:v8 0.0 DESCRIPTION:Explicitly Not Mapped,TITLE:Explicitly Not Mapped CONTROL:v7 0.0 DESCRIPTION:Explicitly Not Mapped,BLANK,BLANK,0.0,BLANK,BLANK,BLANK,BLANK,BLANK,0.0,BLANK,BLANK,BLANK,BLANK,BLANK,http://www.cisco.com/en/US/docs/ios-xml/ios/interface/command/ir-i1.html#GUID-0D6BDFCD-3FBB-4D26-A274-C1221F8592DF:http://www.cisco.com/en/US/docs/ios-xml/ios/iproute_ospf/command/ospf-i1.html#GUID-939C79FF-8C09-4D5A-AEB5-DAF25038CA18,Not set
3.3.3,BLANK,BLANK,Require BGP Authentication if Protocol is Used,BLANK,Border Gateway Protocol (BGP)is a path vector protocol used for interior and exterior gateway routing on some networks.

BGP is a complex protocol, with many configuration options which may have effects which are not immediately obvious.

Verify Border Gateway Protocol (BGP) authentication is enabled, if routing protocol is used, where feasible.,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK,BLANK
3.3.3,3.3.3.1,Level 2,Set 'neighbor password',Automated,Enable message digest5 (MD5) authentication on a TCP connection between two BGP peers,Enforcing routing authentication reduces the likelihood of routing poisoning and unauthorized routers from joining BGP routing.,Organizations should plan and implement enterprise security policies that require rigorous authentication methods for routing protocols. Using the 'neighbor password' for BGP enforces these policies by restricting the type of authentication between network devices.,Configure BGP neighbor authentication where feasible.
```

hostname(config)#router bgp <<em>bgp_as-number</em>>
hostname(config-router)#neighbor <<em>bgp_neighbor-ip</em> | <em>peer-group-name</em>> password <<em>password</em>> 
```,Verify you see the appropriate neighbor password is defined:
```

hostname#sh run | sec router bgp 
```,config file,basic,contain,neighbor\s+\d{1,3}(\.\d{1,3}){3}\s+password\s+\S+,any,none,MD5 authentication between two BGP peers, meaning that each segment sent on the TCP connection between the peers is verified. MD5 authentication must be configured with the same password on both BGP peers.,Medium,TITLE:Explicitly Not Mapped CONTROL:v8 0.0 DESCRIPTION:Explicitly Not Mapped,TITLE:Explicitly Not Mapped CONTROL:v7 0.0 DESCRIPTION:Explicitly Not Mapped,BLANK,BLANK,0.0,BLANK,BLANK,BLANK,BLANK,BLANK,0.0,BLANK,BLANK,BLANK,BLANK,BLANK,http://www.cisco.com/en/US/docs/ios-xml/ios/iproute_bgp/command/bgp-n1.html#GUID-A8900842-ECF3-42D3-B188-921BE0EC060B:http://www.cisco.com/en/US/docs/ios-xml/ios/iproute_bgp/command/bgp-m1.html#GUID-159A8006-F0DF-4B82-BB71-C39D2C134205,Not set
